<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>9&nbsp; Calculations with Aggregate – Introduction to Capital Modeling and Portfolio Management</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./090_EndMatter.html" rel="next">
<link href="./070_AdvancedTopics.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-01c78b5cd655e4cd89133cf59d535862.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-44a2bfbc4aea0d0866ad2a0ddca8a790.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<link rel="icon" href="./static/favicon.ico" type="image/x-icon">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="9&nbsp; Calculations with Aggregate – Introduction to Capital Modeling and Portfolio Management">
<meta property="og:description" content="">
<meta property="og:image" content="https://cmm.mynl.com/080_Calculations_files/figure-html/fig-distortion-functions-output-1.png">
<meta property="og:site_name" content="Introduction to Capital Modeling and Portfolio Management">
<meta property="og:image:height" content="1569">
<meta property="og:image:width" content="3819">
<meta name="twitter:title" content="9&nbsp; Calculations with Aggregate – Introduction to Capital Modeling and Portfolio Management">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://cmm.mynl.com/080_Calculations_files/figure-html/fig-distortion-functions-output-1.png">
<meta name="twitter:image-height" content="1569">
<meta name="twitter:image-width" content="3819">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./080_Calculations.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Calculations with <code>Aggregate</code></span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Capital Modeling and Portfolio Management</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dedication.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dedication</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./010_Introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./020_BusinessOperations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Business operations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./030_CapitalAdequacy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Capital adequacy and sources of risk</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./040_PricingAndAllocation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Pricing and allocation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./050_Applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Applications of pricing and allocation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./060_SelectingSRM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Selecting and calibrating an SRM</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./065_Evaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Evaluating models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./070_AdvancedTopics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Advanced topics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./080_Calculations.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Calculations with <code>Aggregate</code></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./090_EndMatter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Appendices</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliography</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">In this chapter:</h2>
   
  <ul>
  <li><a href="#aggregate-and-python" id="toc-aggregate-and-python" class="nav-link active" data-scroll-target="#aggregate-and-python"><span class="header-section-number">9.1</span> <code>Aggregate</code> and Python</a></li>
  <li><a href="#aggregate-and-r" id="toc-aggregate-and-r" class="nav-link" data-scroll-target="#aggregate-and-r"><span class="header-section-number">9.2</span> <code>Aggregate</code> and R</a></li>
  <li><a href="#sec-setup-code" id="toc-sec-setup-code" class="nav-link" data-scroll-target="#sec-setup-code"><span class="header-section-number">9.3</span> Reproducing the code examples</a></li>
  <li><a href="#sec-sde" id="toc-sec-sde" class="nav-link" data-scroll-target="#sec-sde"><span class="header-section-number">9.4</span> Reproducing the discrete example</a>
  <ul class="collapse">
  <li><a href="#input-data-and-setup" id="toc-input-data-and-setup" class="nav-link" data-scroll-target="#input-data-and-setup"><span class="header-section-number">9.4.1</span> Input data and setup</a></li>
  <li><a href="#premiums-by-distortion" id="toc-premiums-by-distortion" class="nav-link" data-scroll-target="#premiums-by-distortion"><span class="header-section-number">9.4.2</span> Premiums by distortion</a></li>
  <li><a href="#reinsurance-analysis" id="toc-reinsurance-analysis" class="nav-link" data-scroll-target="#reinsurance-analysis"><span class="header-section-number">9.4.3</span> Reinsurance analysis</a></li>
  </ul></li>
  <li><a href="#sec-realistic" id="toc-sec-realistic" class="nav-link" data-scroll-target="#sec-realistic"><span class="header-section-number">9.5</span> A more realistic example</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-Calcs-with-Aggregate" class="quarto-section-identifier"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Calculations with <code>Aggregate</code></span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><em>Example calculations using Python and R.</em></p>
<p>This chapter reproduces many of the exhibits from the main text using Python and the <code>aggregate</code> package. It also describes how to extend to more realistic examples. Throughout, we have included only terse subsets of code so the reader can focus on the results and the output. Instructions for obtaining the full code are provided below.</p>
<section id="aggregate-and-python" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="aggregate-and-python"><span class="header-section-number">9.1</span> <code>Aggregate</code> and Python</h2>
<p><code>aggregate</code> is a Python package that can be used to build approximations to compound (aggregate) probability distributions quickly and accurately, and to solve insurance, risk management, and actuarial problems using realistic models that reflect underlying frequency and severity. It delivers the speed and accuracy of parametric distributions to situations that usually require simulation, making it as easy to work with an aggregate (compound) probability distribution as the lognormal. <code>aggregate</code> includes an expressive language called DecL to describe aggregate distributions.</p>
<p>The <code>aggregate</code> package is available on <a href="https://pypi.org/project/aggregate/">PyPi</a>, the source code is on GitHub at <a href="https://github.com/mynl/aggregate" class="uri">https://github.com/mynl/aggregate</a>, and there is extensive <a href="https://aggregate.readthedocs.io/en/latest/">documentation</a>. The <code>Aggregate</code> class and DecL lanaguage are described in <span class="citation" data-cites="Mildenhall2024">Mildenhall (<a href="references.html#ref-Mildenhall2024" role="doc-biblioref">2024</a>)</span>. There is also an extensive series of videos introducing various capabilities available on <a href="https://www.youtube.com/playlist?list=PLQQxycbewjqMDmw0hfZdB6Rzm60Qcq3Ao">YouTube</a>.</p>
</section>
<section id="aggregate-and-r" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="aggregate-and-r"><span class="header-section-number">9.2</span> <code>Aggregate</code> and R</h2>
<p>Python packages can be used in R via the reticulate library. Python and R code can also be mixed in RMarkdown (now Quarto) files. This <a href="https://www.youtube.com/watch?v=jA9rVMHVqI0">short video</a> explains how to use <code>aggregate</code> from R.</p>
</section>
<section id="sec-setup-code" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="sec-setup-code"><span class="header-section-number">9.3</span> Reproducing the code examples</h2>
<p>To reproduce the Python code examples, you must set up your environment and then install <code>aggregate</code> using</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a>pip install aggregate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The formatting of the examples relies on <code>greater_tables</code>, which can be installed in the same way. The installation process will also install several standard packages, such as <code>numpy</code> and <code>pandas</code>, that it depends on. If you get an error message about other missing packages, you can install them with <code>pip</code>. All the code in the monograph runs on <code>aggregate</code> version 0.24.0 and should run on any later version. If you have an older version installed, you can updated it with <code>pip install -U aggregate</code>.</p>
<p>Once <code>aggregate</code> is installed, start by importing basic libraries. The next code block shows the relevant <code>aggregate</code> function. The class <code>GT</code> from <code>greater_tables</code> is used to format DataFrames consistently.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="im">from</span> aggregate <span class="im">import</span> (</span>
<span id="cb2-2"><a href="#cb2-2"></a>    Portfolio,                  <span class="co"># creates multi-unit portfolios</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>    make_ceder_netter,          <span class="co"># models reinsurance</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>    Distortion                  <span class="co"># creates a Distortion function</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>)</span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="im">from</span> greater_tables <span class="im">import</span> GT   <span class="co"># consistent table format</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Online resources.</strong> Complete code samples can be extracted from the online version of the monograph, available at <a href="https://cmm.mynl.com/" class="uri">https://cmm.mynl.com/</a>. Each code block has a small copy icon in the upper right-hand corner. The code blocks on each page can all be shown or hidden using the <code>&lt;/&gt;Code</code> control at the top of the page. To download the original qmd file, use the View Source option under the same control. Alternatively, the entire Quarto (previously RMarkdown) source can be downloaded from GitHub at https://github.com/mynl/CapitalModeling (CAS TO INSERT OWN LINK).</p>
</section>
<section id="sec-sde" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="sec-sde"><span class="header-section-number">9.4</span> Reproducing the discrete example</h2>
<section id="input-data-and-setup" class="level3" data-number="9.4.1">
<h3 data-number="9.4.1" class="anchored" data-anchor-id="input-data-and-setup"><span class="header-section-number">9.4.1</span> Input data and setup</h3>
<p>The InsCo example running through this monograph is based on the 10 events shown in <a href="#tbl-10-sims" class="quarto-xref">Table&nbsp;<span>9.1</span></a>, which reproduces <a href="020_BusinessOperations.html#tbl-dupe-x" class="quarto-xref">Table&nbsp;<span>2.1</span></a>, and adds the mean and CV. For reference, here is the code to create the underlying dataframe.</p>
<div id="lstx-loss-sample" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a>loss_sample <span class="op">=</span> pd.DataFrame(</span>
<span id="cb3-2"><a href="#cb3-2"></a>    {</span>
<span id="cb3-3"><a href="#cb3-3"></a>        <span class="st">'A'</span>: [ <span class="dv">5</span>,  <span class="dv">7</span>, <span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">13</span>,  <span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">26</span>, <span class="dv">17</span>, <span class="dv">16</span>],</span>
<span id="cb3-4"><a href="#cb3-4"></a>        <span class="st">'B'</span>: [<span class="dv">20</span>, <span class="dv">33</span>, <span class="dv">13</span>,  <span class="dv">7</span>, <span class="dv">20</span>, <span class="dv">27</span>, <span class="dv">16</span>, <span class="dv">19</span>,  <span class="dv">8</span>, <span class="dv">20</span>],</span>
<span id="cb3-5"><a href="#cb3-5"></a>        <span class="st">'C'</span>: [<span class="dv">11</span>,  <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">7</span>,  <span class="dv">8</span>,  <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">40</span>, <span class="dv">64</span>],</span>
<span id="cb3-6"><a href="#cb3-6"></a>    }</span>
<span id="cb3-7"><a href="#cb3-7"></a>)</span>
<span id="cb3-8"><a href="#cb3-8"></a>loss_sample[<span class="st">'total'</span>] <span class="op">=</span> loss_sample.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb3-9"><a href="#cb3-9"></a>loss_sample[<span class="st">'p_total'</span>] <span class="op">=</span> <span class="dv">1</span><span class="op">/</span><span class="dv">10</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="bu">print</span>(loss_sample)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    A   B   C  total  p_total
0   5  20  11     36      0.1
1   7  33   0     40      0.1
2  15  13   0     28      0.1
3  15   7   0     22      0.1
4  13  20   7     40      0.1
5   5  27   8     40      0.1
6  15  16   9     40      0.1
7  26  19  10     55      0.1
8  17   8  40     65      0.1
9  16  20  64    100      0.1</code></pre>
</div>
</div>
<div class="cell" data-execution_count="5">
<div id="tbl-10-sims" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="5">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-10-sims-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9.1: The 10 equally likely simulations underlying the basic examples.
</figcaption>
<div aria-describedby="tbl-10-sims-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="4">
<div class="greater-table">
<style>
    #T2DABV6AJ5YVS  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #T2DABV6AJ5YVS caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #T2DABV6AJ5YVS thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #T2DABV6AJ5YVS tbody {
        
        border-bottom: 1px solid #000;
        }
    #T2DABV6AJ5YVS th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #T2DABV6AJ5YVS td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #T2DABV6AJ5YVS .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #T2DABV6AJ5YVS .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #T2DABV6AJ5YVS .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #T2DABV6AJ5YVS .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #T2DABV6AJ5YVS .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #T2DABV6AJ5YVS .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #T2DABV6AJ5YVS .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #T2DABV6AJ5YVS .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #T2DABV6AJ5YVS .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #T2DABV6AJ5YVS .grt-left {
        text-align: left;
    }
    #T2DABV6AJ5YVS .grt-center {
        text-align: center;
    }
    #T2DABV6AJ5YVS .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #T2DABV6AJ5YVS .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #T2DABV6AJ5YVS .grt-bold {
        font-weight: bold;
    }

</style>

<table id="T2DABV6AJ5YVS" class="do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" data-quarto-table-cell-role="th">index</th>
<th class="grt-center grt-vrule-index" data-quarto-table-cell-role="th">A</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">B</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">C</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left">0</td>
<td class="grt-c-1 grt-right grt-vrule-index">5</td>
<td class="grt-c-2 grt-right grt-vrule-0">20</td>
<td class="grt-c-3 grt-right grt-vrule-0">11</td>
<td class="grt-c-4 grt-right grt-vrule-0">72</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left">1</td>
<td class="grt-c-1 grt-right grt-vrule-index">7</td>
<td class="grt-c-2 grt-right grt-vrule-0">33</td>
<td class="grt-c-3 grt-right grt-vrule-0">0</td>
<td class="grt-c-4 grt-right grt-vrule-0">80</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left">2</td>
<td class="grt-c-1 grt-right grt-vrule-index">15</td>
<td class="grt-c-2 grt-right grt-vrule-0">13</td>
<td class="grt-c-3 grt-right grt-vrule-0">0</td>
<td class="grt-c-4 grt-right grt-vrule-0">56</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left">3</td>
<td class="grt-c-1 grt-right grt-vrule-index">15</td>
<td class="grt-c-2 grt-right grt-vrule-0">7</td>
<td class="grt-c-3 grt-right grt-vrule-0">0</td>
<td class="grt-c-4 grt-right grt-vrule-0">44</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left">4</td>
<td class="grt-c-1 grt-right grt-vrule-index">13</td>
<td class="grt-c-2 grt-right grt-vrule-0">20</td>
<td class="grt-c-3 grt-right grt-vrule-0">7</td>
<td class="grt-c-4 grt-right grt-vrule-0">80</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left">5</td>
<td class="grt-c-1 grt-right grt-vrule-index">5</td>
<td class="grt-c-2 grt-right grt-vrule-0">27</td>
<td class="grt-c-3 grt-right grt-vrule-0">8</td>
<td class="grt-c-4 grt-right grt-vrule-0">80</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left">6</td>
<td class="grt-c-1 grt-right grt-vrule-index">15</td>
<td class="grt-c-2 grt-right grt-vrule-0">16</td>
<td class="grt-c-3 grt-right grt-vrule-0">9</td>
<td class="grt-c-4 grt-right grt-vrule-0">80</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left">7</td>
<td class="grt-c-1 grt-right grt-vrule-index">26</td>
<td class="grt-c-2 grt-right grt-vrule-0">19</td>
<td class="grt-c-3 grt-right grt-vrule-0">10</td>
<td class="grt-c-4 grt-right grt-vrule-0">110</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left">8</td>
<td class="grt-c-1 grt-right grt-vrule-index">17</td>
<td class="grt-c-2 grt-right grt-vrule-0">8</td>
<td class="grt-c-3 grt-right grt-vrule-0">40</td>
<td class="grt-c-4 grt-right grt-vrule-0">130</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left">9</td>
<td class="grt-c-1 grt-right grt-vrule-index">16</td>
<td class="grt-c-2 grt-right grt-vrule-0">20</td>
<td class="grt-c-3 grt-right grt-vrule-0">64</td>
<td class="grt-c-4 grt-right grt-vrule-0">200</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left">EX</td>
<td class="grt-c-1 grt-right grt-vrule-index">13.4</td>
<td class="grt-c-2 grt-right grt-vrule-0">18.3</td>
<td class="grt-c-3 grt-right grt-vrule-0">14.9</td>
<td class="grt-c-4 grt-right grt-vrule-0">93.2</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left">CV</td>
<td class="grt-c-1 grt-right grt-vrule-index">0.453</td>
<td class="grt-c-2 grt-right grt-vrule-0">0.412</td>
<td class="grt-c-3 grt-right grt-vrule-0">1.324</td>
<td class="grt-c-4 grt-right grt-vrule-0">0.455</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>Now we create an <code>aggregate</code> <code>Portfolio</code> class instance based on the <code>loss_sample</code> simulation output. The next block shows how to do this, using the <code>Portfolio.create_from_sample</code> method. <code>TMA1</code> is a label, and <code>loss_sample</code> is the dataframe created previously. The other arguments specify working with unit-sized buckets <code>bs=1</code> appropriate for our integer losses and to use <span class="math inline">\(256=2^8\)</span> buckets, <code>log2=8</code>.</p>
<div id="lstx-create-port" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>wport <span class="op">=</span> Portfolio.create_from_sample(<span class="st">'TMA1'</span>, loss_sample, bs<span class="op">=</span><span class="dv">1</span>, log2<span class="op">=</span><span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The next line of code displays <a href="#tbl-wport" class="quarto-xref">Table&nbsp;<span>9.2</span></a>, which shows summary output from the object <code>wport</code> by accessing its <code>describe</code> attribute. The summary includes the mean, CV, and skewness. The model and estimated (<code>Est</code>) columns are identical because we specified the distribution directly; no simulation or Fast Fourier Transform-based numerical methods are employed.</p>
<div class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>fGT(wport.describe.drop(columns<span class="op">=</span>[<span class="st">'Err E[X]'</span>, <span class="st">'Err CV(X)'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-wport" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="7">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-wport-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9.2: Summary statistics for the base example.
</figcaption>
<div aria-describedby="tbl-wport-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="6">
<div class="greater-table">
<style>
    #T3FNAV4WTPE5V  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #T3FNAV4WTPE5V caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #T3FNAV4WTPE5V thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #T3FNAV4WTPE5V tbody {
        
        border-bottom: 1px solid #000;
        }
    #T3FNAV4WTPE5V th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #T3FNAV4WTPE5V td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #T3FNAV4WTPE5V .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #T3FNAV4WTPE5V .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #T3FNAV4WTPE5V .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #T3FNAV4WTPE5V .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #T3FNAV4WTPE5V .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #T3FNAV4WTPE5V .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #T3FNAV4WTPE5V .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #T3FNAV4WTPE5V .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #T3FNAV4WTPE5V .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #T3FNAV4WTPE5V .grt-left {
        text-align: left;
    }
    #T3FNAV4WTPE5V .grt-center {
        text-align: center;
    }
    #T3FNAV4WTPE5V .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #T3FNAV4WTPE5V .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #T3FNAV4WTPE5V .grt-bold {
        font-weight: bold;
    }

</style>

<table id="T3FNAV4WTPE5V" class="do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" data-quarto-table-cell-role="th">unit</th>
<th class="grt-left" data-quarto-table-cell-role="th">X</th>
<th class="grt-center grt-vrule-index" data-quarto-table-cell-role="th">E[X]</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">Est E[X]</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">CV(X)</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">Est CV(X)</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">Skew(X)</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">Est Skew(X)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left">A</td>
<td class="grt-c-1 grt-left">Freq</td>
<td class="grt-c-2 grt-right grt-vrule-index">1</td>
<td class="grt-c-3 grt-right grt-vrule-0"></td>
<td class="grt-c-4 grt-right grt-vrule-0">0</td>
<td class="grt-c-5 grt-right grt-vrule-0"></td>
<td class="grt-c-6 grt-right grt-vrule-0"></td>
<td class="grt-c-7 grt-right grt-vrule-0"></td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Sev</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">13.4</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">13.4</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">0.453</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0">0.453</td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">0.281</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0">0.281</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Agg</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">13.4</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">13.4</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">0.453</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0">0.453</td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">0.281</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0">0.281</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0">B</td>
<td class="grt-c-1 grt-left grt-hrule-0">Freq</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-index">1</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0"></td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0">0</td>
<td class="grt-c-5 grt-right grt-hrule-0 grt-vrule-0"></td>
<td class="grt-c-6 grt-right grt-hrule-0 grt-vrule-0"></td>
<td class="grt-c-7 grt-right grt-hrule-0 grt-vrule-0"></td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Sev</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">18.300</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">18.300</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">0.412</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0">0.412</td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">0.269</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0">0.269</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Agg</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">18.300</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">18.300</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">0.412</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0">0.412</td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">0.269</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0">0.269</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0">C</td>
<td class="grt-c-1 grt-left grt-hrule-0">Freq</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-index">1</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0"></td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0">0</td>
<td class="grt-c-5 grt-right grt-hrule-0 grt-vrule-0"></td>
<td class="grt-c-6 grt-right grt-hrule-0 grt-vrule-0"></td>
<td class="grt-c-7 grt-right grt-hrule-0 grt-vrule-0"></td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Sev</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">14.9</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">14.900</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">1.324</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0">1.324</td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">1.603</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0">1.603</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Agg</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">14.9</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">14.900</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">1.324</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0">1.324</td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">1.603</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0">1.603</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0">total</td>
<td class="grt-c-1 grt-left grt-hrule-0">Freq</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-index">3</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0"></td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0">0</td>
<td class="grt-c-5 grt-right grt-hrule-0 grt-vrule-0"></td>
<td class="grt-c-6 grt-right grt-hrule-0 grt-vrule-0"></td>
<td class="grt-c-7 grt-right grt-hrule-0 grt-vrule-0"></td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Sev</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">15.533</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">15.533</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">0.827</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0"></td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">1.884</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0"></td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Agg</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">46.6</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">46.600</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">0.471</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0">0.471</td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">1.177</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0">1.177</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>Next, we need to calibrate distortion functions to achieve the desired pricing. The example uses full capitalization throughout (assets equal the maximum loss), which is equivalent to a 100% percentile level (see <a href="#tbl-quantiles" class="quarto-xref">Table&nbsp;<span>9.5</span></a>) and assumes the cost of capital is 15%. The code runs the calibration by calling <code>wport.calibrate_distortions</code> with arguments for the capital percentile level <code>Ps</code> and cost of capital <code>COCs</code>. The arguments are passed as lists because the routine can be used to solve for several percentile levels and costs simultaneously. <a href="#tbl-9-1" class="quarto-xref">Table&nbsp;<span>9.3</span></a> shows the resulting parameters, which match those in <a href="040_PricingAndAllocation.html#tbl-the5dists" class="quarto-xref">Table&nbsp;<span>4.5</span></a>.</p>
<div id="lstx-9-1" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># calibrate to 15% return at p=100% capital standard</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>wport.calibrate_distortions(Ps<span class="op">=</span>[<span class="dv">1</span>], COCs<span class="op">=</span>[<span class="fl">.15</span>])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="9">
<div id="tbl-9-1" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="9">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-9-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9.3: Distortion functions calibrated to 15% return on full capital.
</figcaption>
<div aria-describedby="tbl-9-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="8">
<div class="greater-table">
<style>
    #TKOYDWZLELYBU  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #TKOYDWZLELYBU caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #TKOYDWZLELYBU thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #TKOYDWZLELYBU tbody {
        
        border-bottom: 1px solid #000;
        }
    #TKOYDWZLELYBU th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #TKOYDWZLELYBU td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #TKOYDWZLELYBU .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #TKOYDWZLELYBU .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #TKOYDWZLELYBU .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #TKOYDWZLELYBU .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #TKOYDWZLELYBU .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #TKOYDWZLELYBU .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #TKOYDWZLELYBU .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #TKOYDWZLELYBU .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #TKOYDWZLELYBU .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #TKOYDWZLELYBU .grt-left {
        text-align: left;
    }
    #TKOYDWZLELYBU .grt-center {
        text-align: center;
    }
    #TKOYDWZLELYBU .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #TKOYDWZLELYBU .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #TKOYDWZLELYBU .grt-bold {
        font-weight: bold;
    }

</style>

<table id="TKOYDWZLELYBU" class="do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" data-quarto-table-cell-role="th">method</th>
<th class="grt-center grt-vrule-index" data-quarto-table-cell-role="th">P</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">param</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left">ccoc</td>
<td class="grt-c-1 grt-right grt-vrule-index">53.565</td>
<td class="grt-c-2 grt-right grt-vrule-0">0.150</td>
<td class="grt-c-3 grt-right grt-vrule-0">0</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0">ph</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index">53.565</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0">0.720</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0">0.000</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0">wang</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index">53.565</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0">0.343</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0">0.000</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0">dual</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index">53.565</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0">1.595</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0">-0.000</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0">tvar</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index">53.565</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0">0.271</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<p><a href="#fig-distortion-functions" class="quarto-xref">Figure&nbsp;<span>9.1</span></a> shows the resulting distortion <span class="math inline">\(g\)</span> functions (top) and the probability adjustment <span class="math inline">\(Z=q/p\)</span> (bottom). The red star indicates a probability mass at <span class="math inline">\(p=1\)</span>.</p>
<div id="cell-fig-distortion-functions" class="cell" data-execution_count="10">
<div class="cell-output cell-output-display">
<div id="fig-distortion-functions" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-distortion-functions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="080_Calculations_files/figure-html/fig-distortion-functions-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;9.1: Distortion functions (top row) and distortion probability adjustment functions (bottom row)."><img src="080_Calculations_files/figure-html/fig-distortion-functions-output-1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-distortion-functions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.1: Distortion functions (top row) and distortion probability adjustment functions (bottom row).
</figcaption>
</figure>
</div>
</div>
</div>
<p>For technical reasons (discussed in <a href="040_PricingAndAllocation.html#sec-Complications" class="quarto-xref"><span>Section 4.3</span></a> as well as chapter 14.1.5 in <span class="citation" data-cites="PIR">Mildenhall and Major (<a href="references.html#ref-PIR" role="doc-biblioref">2022</a>)</span>, see especially Figure 14.2), we must summarize the 10 events by distinct totals. Routine code produces <a href="#tbl-5-1" class="quarto-xref">Table&nbsp;<span>9.4</span></a>, reproducing <a href="040_PricingAndAllocation.html#tbl-abc-x" class="quarto-xref">Table&nbsp;<span>4.2</span></a>. <!--# In Table 9.4, the data in the row for index 3 go to the thousandths, while the other rows at most go to tenths. Suggest revising the data in row Index 3 so that it is similar to that of other rows. --></p>
<div class="cell" data-execution_count="11">
<div id="tbl-5-1" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="11">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-5-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9.4: Assumptions for portfolio, summarized by distinct totals.
</figcaption>
<div aria-describedby="tbl-5-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="10">
<div class="greater-table">
<style>
    #TZQHPYMHSVAPH  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #TZQHPYMHSVAPH caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #TZQHPYMHSVAPH thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #TZQHPYMHSVAPH tbody {
        
        border-bottom: 1px solid #000;
        }
    #TZQHPYMHSVAPH th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #TZQHPYMHSVAPH td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #TZQHPYMHSVAPH .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #TZQHPYMHSVAPH .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #TZQHPYMHSVAPH .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #TZQHPYMHSVAPH .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #TZQHPYMHSVAPH .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #TZQHPYMHSVAPH .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #TZQHPYMHSVAPH .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #TZQHPYMHSVAPH .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #TZQHPYMHSVAPH .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #TZQHPYMHSVAPH .grt-left {
        text-align: left;
    }
    #TZQHPYMHSVAPH .grt-center {
        text-align: center;
    }
    #TZQHPYMHSVAPH .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #TZQHPYMHSVAPH .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #TZQHPYMHSVAPH .grt-bold {
        font-weight: bold;
    }

</style>

<table id="TZQHPYMHSVAPH" class="do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" data-quarto-table-cell-role="th">index</th>
<th class="grt-center grt-vrule-index" data-quarto-table-cell-role="th">A</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">B</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">C</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">p</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left">0</td>
<td class="grt-c-1 grt-right grt-vrule-index">15</td>
<td class="grt-c-2 grt-right grt-vrule-0">7</td>
<td class="grt-c-3 grt-right grt-vrule-0">0</td>
<td class="grt-c-4 grt-right grt-vrule-0">0.1</td>
<td class="grt-c-5 grt-right grt-vrule-0">22</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left">1</td>
<td class="grt-c-1 grt-right grt-vrule-index">15</td>
<td class="grt-c-2 grt-right grt-vrule-0">13</td>
<td class="grt-c-3 grt-right grt-vrule-0">0</td>
<td class="grt-c-4 grt-right grt-vrule-0">0.1</td>
<td class="grt-c-5 grt-right grt-vrule-0">28</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left">2</td>
<td class="grt-c-1 grt-right grt-vrule-index">5</td>
<td class="grt-c-2 grt-right grt-vrule-0">20</td>
<td class="grt-c-3 grt-right grt-vrule-0">11</td>
<td class="grt-c-4 grt-right grt-vrule-0">0.1</td>
<td class="grt-c-5 grt-right grt-vrule-0">36</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left">3</td>
<td class="grt-c-1 grt-right grt-vrule-index">10</td>
<td class="grt-c-2 grt-right grt-vrule-0">24.000</td>
<td class="grt-c-3 grt-right grt-vrule-0">6.000</td>
<td class="grt-c-4 grt-right grt-vrule-0">0.4</td>
<td class="grt-c-5 grt-right grt-vrule-0">40</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left">4</td>
<td class="grt-c-1 grt-right grt-vrule-index">26</td>
<td class="grt-c-2 grt-right grt-vrule-0">19</td>
<td class="grt-c-3 grt-right grt-vrule-0">10</td>
<td class="grt-c-4 grt-right grt-vrule-0">0.1</td>
<td class="grt-c-5 grt-right grt-vrule-0">55</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left">5</td>
<td class="grt-c-1 grt-right grt-vrule-index">17</td>
<td class="grt-c-2 grt-right grt-vrule-0">8</td>
<td class="grt-c-3 grt-right grt-vrule-0">40</td>
<td class="grt-c-4 grt-right grt-vrule-0">0.1</td>
<td class="grt-c-5 grt-right grt-vrule-0">65</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left">6</td>
<td class="grt-c-1 grt-right grt-vrule-index">16</td>
<td class="grt-c-2 grt-right grt-vrule-0">20</td>
<td class="grt-c-3 grt-right grt-vrule-0">64</td>
<td class="grt-c-4 grt-right grt-vrule-0">0.1</td>
<td class="grt-c-5 grt-right grt-vrule-0">100</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left">EX</td>
<td class="grt-c-1 grt-right grt-vrule-index">13.4</td>
<td class="grt-c-2 grt-right grt-vrule-0">18.3</td>
<td class="grt-c-3 grt-right grt-vrule-0">14.9</td>
<td class="grt-c-4 grt-right grt-vrule-0">1</td>
<td class="grt-c-5 grt-right grt-vrule-0">46.6</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left">Plan</td>
<td class="grt-c-1 grt-right grt-vrule-index">13.9</td>
<td class="grt-c-2 grt-right grt-vrule-0">18.7</td>
<td class="grt-c-3 grt-right grt-vrule-0">19.6</td>
<td class="grt-c-4 grt-right grt-vrule-0">1</td>
<td class="grt-c-5 grt-right grt-vrule-0">52.2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>The examples describe a VaR- or TVaR-based capital standard (see <a href="030_CapitalAdequacy.html#tbl-CA-loss-levels" class="quarto-xref">Table&nbsp;<span>3.1</span></a>), but for this example it works out to the the same as a fully capitalized 100% standard, as shown by the values in <a href="#tbl-quantiles" class="quarto-xref">Table&nbsp;<span>9.5</span></a>. The <code>wport</code> methods <code>q</code> and <code>tvar</code> compute quantiles and TVaRs for each unit and the total.</p>
<div class="cell" data-execution_count="12">
<div id="tbl-quantiles" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="12">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-quantiles-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9.5: Quantiles (VaR) and TVaR at different probability levels.
</figcaption>
<div aria-describedby="tbl-quantiles-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="11">
<div class="greater-table">
<style>
    #TIMRM4ZKT46KC  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #TIMRM4ZKT46KC caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #TIMRM4ZKT46KC thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #TIMRM4ZKT46KC tbody {
        
        border-bottom: 1px solid #000;
        }
    #TIMRM4ZKT46KC th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #TIMRM4ZKT46KC td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #TIMRM4ZKT46KC .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #TIMRM4ZKT46KC .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #TIMRM4ZKT46KC .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #TIMRM4ZKT46KC .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #TIMRM4ZKT46KC .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #TIMRM4ZKT46KC .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #TIMRM4ZKT46KC .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #TIMRM4ZKT46KC .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #TIMRM4ZKT46KC .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #TIMRM4ZKT46KC .grt-left {
        text-align: left;
    }
    #TIMRM4ZKT46KC .grt-center {
        text-align: center;
    }
    #TIMRM4ZKT46KC .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #TIMRM4ZKT46KC .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #TIMRM4ZKT46KC .grt-bold {
        font-weight: bold;
    }

</style>

<table id="TIMRM4ZKT46KC" class="do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" data-quarto-table-cell-role="th">p</th>
<th class="grt-center grt-vrule-index" data-quarto-table-cell-role="th">Quantile</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">TVaR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left">0.8</td>
<td class="grt-c-1 grt-right grt-vrule-index">55</td>
<td class="grt-c-2 grt-right grt-vrule-0">82.500</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0">0.850</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index">65</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0">88.333</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0">0.9</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index">65</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0">100</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0">1</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index">100</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0">100</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="premiums-by-distortion" class="level3" data-number="9.4.2">
<h3 data-number="9.4.2" class="anchored" data-anchor-id="premiums-by-distortion"><span class="header-section-number">9.4.2</span> Premiums by distortion</h3>
<p><a href="040_PricingAndAllocation.html#tbl-isa-alloc" class="quarto-xref">Table&nbsp;<span>4.11</span></a> shows premium assuming a CCoC distortion with a 15% return applied using a 100% capital standard. The premium <code>P</code> row shows what <span class="citation" data-cites="PIR">Mildenhall and Major (<a href="references.html#ref-PIR" role="doc-biblioref">2022</a>)</span> calls the linear NA premium. <a href="#tbl-ccoc-na" class="quarto-xref">Table&nbsp;<span>9.6</span></a> reproduces this exhibit, confirming an equal 15% returns across all allocated capital. The code illustrates the power of <code>aggregate</code>. The first line creates a CCoC distortion using the <code>Distortion</code> class; note the argument is risk discount <span class="math inline">\(\delta\)</span>. The second line uses the <code>price</code> method to compute the linear allocation, which it returns in a structure with various diagnostic information, including <a href="#tbl-ccoc-na" class="quarto-xref">Table&nbsp;<span>9.6</span></a>. <!--# In Table 9.6, I would capitalize "Total," so it matches the style of other tables. --></p>
<div id="lstx-ccoc-na-0" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>ccoc <span class="op">=</span> Distortion.ccoc(<span class="fl">.15</span> <span class="op">/</span> <span class="fl">1.15</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a>pricing_info <span class="op">=</span> wport.price(<span class="dv">1</span>, ccoc, allocation<span class="op">=</span><span class="st">'linear'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="14">
<div id="tbl-ccoc-na" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="14">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ccoc-na-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9.6: Industry standard approach pricing using the CCoC distortion.
</figcaption>
<div aria-describedby="tbl-ccoc-na-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="13">
<div class="greater-table">
<style>
    #TBUEK4ZNJHITY  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #TBUEK4ZNJHITY caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #TBUEK4ZNJHITY thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #TBUEK4ZNJHITY tbody {
        
        border-bottom: 1px solid #000;
        }
    #TBUEK4ZNJHITY th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #TBUEK4ZNJHITY td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #TBUEK4ZNJHITY .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #TBUEK4ZNJHITY .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #TBUEK4ZNJHITY .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #TBUEK4ZNJHITY .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #TBUEK4ZNJHITY .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #TBUEK4ZNJHITY .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #TBUEK4ZNJHITY .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #TBUEK4ZNJHITY .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #TBUEK4ZNJHITY .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #TBUEK4ZNJHITY .grt-left {
        text-align: left;
    }
    #TBUEK4ZNJHITY .grt-center {
        text-align: center;
    }
    #TBUEK4ZNJHITY .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #TBUEK4ZNJHITY .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #TBUEK4ZNJHITY .grt-bold {
        font-weight: bold;
    }

</style>

<table id="TBUEK4ZNJHITY" class="do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" data-quarto-table-cell-role="th">index</th>
<th class="grt-center grt-vrule-index" data-quarto-table-cell-role="th">A</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">B</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">C</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left">L</td>
<td class="grt-c-1 grt-right grt-vrule-index">13.4</td>
<td class="grt-c-2 grt-right grt-vrule-0">18.3</td>
<td class="grt-c-3 grt-right grt-vrule-0">14.900</td>
<td class="grt-c-4 grt-right grt-vrule-0">46.6</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left">a</td>
<td class="grt-c-1 grt-right grt-vrule-index">16.000</td>
<td class="grt-c-2 grt-right grt-vrule-0">20.000</td>
<td class="grt-c-3 grt-right grt-vrule-0">64.000</td>
<td class="grt-c-4 grt-right grt-vrule-0">100</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left">Q</td>
<td class="grt-c-1 grt-right grt-vrule-index">2.261</td>
<td class="grt-c-2 grt-right grt-vrule-0">1.478</td>
<td class="grt-c-3 grt-right grt-vrule-0">42.696</td>
<td class="grt-c-4 grt-right grt-vrule-0">46.435</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left">P</td>
<td class="grt-c-1 grt-right grt-vrule-index">13.739</td>
<td class="grt-c-2 grt-right grt-vrule-0">18.522</td>
<td class="grt-c-3 grt-right grt-vrule-0">21.304</td>
<td class="grt-c-4 grt-right grt-vrule-0">53.565</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left">M</td>
<td class="grt-c-1 grt-right grt-vrule-index">0.339</td>
<td class="grt-c-2 grt-right grt-vrule-0">0.222</td>
<td class="grt-c-3 grt-right grt-vrule-0">6.404</td>
<td class="grt-c-4 grt-right grt-vrule-0">6.965</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left">COC</td>
<td class="grt-c-1 grt-right grt-vrule-index">0.150</td>
<td class="grt-c-2 grt-right grt-vrule-0">0.150</td>
<td class="grt-c-3 grt-right grt-vrule-0">0.150</td>
<td class="grt-c-4 grt-right grt-vrule-0">0.150</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<p><a href="040_PricingAndAllocation.html#tbl-x-collapsed" class="quarto-xref">Table&nbsp;<span>4.3</span></a>, <a href="040_PricingAndAllocation.html#tbl-ccoc-1" class="quarto-xref">Table&nbsp;<span>4.4</span></a> and <a href="040_PricingAndAllocation.html#tbl-ccoc-qx" class="quarto-xref">Table&nbsp;<span>4.10</span></a> compute <span class="math inline">\(\rho(X)\)</span> for <span class="math inline">\(\rho\)</span> the CCoC SRM, using the <span class="math inline">\(\rho(X)=\int g(S(x))\,dx\)</span> (second table) and <span class="math inline">\(\rho(X)=\int xg'(S(x))f(x)\,dx\)</span> (third) representations. The numbers needed for these calculations are shown in <a href="#tbl-gs-calcs" class="quarto-xref">Table&nbsp;<span>9.7</span></a>, where <span class="math inline">\(q=g'(S(x))f(x)\)</span>. These are extracted from the dataframe <code>wport.density_df,</code> which contains the probability mass, density, and survival functions for the portfolio, among other facts. The last row carries out the calculations and confirms the two methods give the same result, the total under <span class="math inline">\(gS\)</span> using the former representation and under <span class="math inline">\(q\)</span> using the latter representation.</p>
<div class="cell" data-execution_count="15">
<div id="tbl-gs-calcs" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="15">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-gs-calcs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9.7: Industry standard approach pricing: raw ingredients and computed means.
</figcaption>
<div aria-describedby="tbl-gs-calcs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="14">
<div class="greater-table">
<style>
    #TRLS3U5NWH62S  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #TRLS3U5NWH62S caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #TRLS3U5NWH62S thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #TRLS3U5NWH62S tbody {
        
        border-bottom: 1px solid #000;
        }
    #TRLS3U5NWH62S th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #TRLS3U5NWH62S td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #TRLS3U5NWH62S .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #TRLS3U5NWH62S .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #TRLS3U5NWH62S .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #TRLS3U5NWH62S .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #TRLS3U5NWH62S .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #TRLS3U5NWH62S .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #TRLS3U5NWH62S .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #TRLS3U5NWH62S .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #TRLS3U5NWH62S .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #TRLS3U5NWH62S .grt-left {
        text-align: left;
    }
    #TRLS3U5NWH62S .grt-center {
        text-align: center;
    }
    #TRLS3U5NWH62S .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #TRLS3U5NWH62S .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #TRLS3U5NWH62S .grt-bold {
        font-weight: bold;
    }

</style>

<table id="TRLS3U5NWH62S" class="do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" data-quarto-table-cell-role="th">loss</th>
<th class="grt-center grt-vrule-index" data-quarto-table-cell-role="th">p_total</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">F</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">S</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">gS</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">q</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">ΔX</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left">22</td>
<td class="grt-c-1 grt-right grt-vrule-index">0.1</td>
<td class="grt-c-2 grt-right grt-vrule-0">0.1</td>
<td class="grt-c-3 grt-right grt-vrule-0">0.9</td>
<td class="grt-c-4 grt-right grt-vrule-0">0.913</td>
<td class="grt-c-5 grt-right grt-vrule-0">0.087</td>
<td class="grt-c-6 grt-right grt-vrule-0">6</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0">28</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index">0.1</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0">0.2</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0">0.8</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0">0.826</td>
<td class="grt-c-5 grt-right grt-hrule-0 grt-vrule-0">0.087</td>
<td class="grt-c-6 grt-right grt-hrule-0 grt-vrule-0">8</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0">36</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index">0.1</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0">0.3</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0">0.7</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0">0.739</td>
<td class="grt-c-5 grt-right grt-hrule-0 grt-vrule-0">0.087</td>
<td class="grt-c-6 grt-right grt-hrule-0 grt-vrule-0">4</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0">40</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index">0.4</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0">0.7</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0">0.3</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0">0.391</td>
<td class="grt-c-5 grt-right grt-hrule-0 grt-vrule-0">0.348</td>
<td class="grt-c-6 grt-right grt-hrule-0 grt-vrule-0">15</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0">55</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index">0.1</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0">0.8</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0">0.2</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0">0.304</td>
<td class="grt-c-5 grt-right grt-hrule-0 grt-vrule-0">0.087</td>
<td class="grt-c-6 grt-right grt-hrule-0 grt-vrule-0">10</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0">65</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index">0.1</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0">0.9</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0">0.1</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0">0.217</td>
<td class="grt-c-5 grt-right grt-hrule-0 grt-vrule-0">0.087</td>
<td class="grt-c-6 grt-right grt-hrule-0 grt-vrule-0">35</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0">100</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index">0.1</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0">1</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0">0</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0">0</td>
<td class="grt-c-5 grt-right grt-hrule-0 grt-vrule-0">0.217</td>
<td class="grt-c-6 grt-right grt-hrule-0 grt-vrule-0">0</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0">\(\rho(X)\)</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index"></td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0"></td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0"></td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0">53.565</td>
<td class="grt-c-5 grt-right grt-hrule-0 grt-vrule-0">53.565</td>
<td class="grt-c-6 grt-right grt-hrule-0 grt-vrule-0"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<!-- @tbl-Wang-alloc shows the results of using the Wang distortion in place of the CCoC.  -->
<p><a href="#tbl-all-distortion-pricing" class="quarto-xref">Table&nbsp;<span>9.8</span></a> shows the results for the other standard distortions. The calculations match those of the Wang in <a href="#tbl-all-distortion-pricing-3" class="quarto-xref">Table&nbsp;<span>9.8 (c)</span></a>. All of the calibrated distortions are carried in the dictionary <code>wport.dists</code>. These tables also include the NA of capital (a process we do not recommend, but that is described in <a href="070_AdvancedTopics.html#sec-Allocating-Capital" class="quarto-xref"><span>Section 8.3</span></a>). The <code>Q</code> row matches the calculation of allocated capital shown in <a href="070_AdvancedTopics.html#tbl-q-alloc" class="quarto-xref">Table&nbsp;<span>8.10</span></a>. <!--# In Table 9.8, I also recommend capitalizing "Total" in the fourth column all all panels for consistency. --></p>
<div id="tbl-all-distortion-pricing" class="quarto-layout-panel anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-all-distortion-pricing-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9.8: Pricing by distortion by unit.
</figcaption>
<div aria-describedby="tbl-all-distortion-pricing-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-all-distortion-pricing" style="flex-basis: 100.0%;justify-content: center;">
<div class="greater-table">
<style>
    #TLBCN2UEPVTX7  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #TLBCN2UEPVTX7 caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #TLBCN2UEPVTX7 thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #TLBCN2UEPVTX7 tbody {
        
        border-bottom: 1px solid #000;
        }
    #TLBCN2UEPVTX7 th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #TLBCN2UEPVTX7 td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #TLBCN2UEPVTX7 .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #TLBCN2UEPVTX7 .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #TLBCN2UEPVTX7 .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #TLBCN2UEPVTX7 .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #TLBCN2UEPVTX7 .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #TLBCN2UEPVTX7 .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #TLBCN2UEPVTX7 .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #TLBCN2UEPVTX7 .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #TLBCN2UEPVTX7 .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #TLBCN2UEPVTX7 .grt-left {
        text-align: left;
    }
    #TLBCN2UEPVTX7 .grt-center {
        text-align: center;
    }
    #TLBCN2UEPVTX7 .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #TLBCN2UEPVTX7 .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #TLBCN2UEPVTX7 .grt-bold {
        font-weight: bold;
    }

</style>

<div id="tbl-all-distortion-pricing-1" class="do-not-create-environment quarto-float quarto-figure quarto-figure-center anchored" data-quarto-postprocess="true">
<figure class="quarto-float quarto-subfloat-tbl figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-all-distortion-pricing-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) CCoC
</figcaption>
<div aria-describedby="tbl-all-distortion-pricing-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-all-distortion-pricing-1" class="do-not-create-environment caption-top table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" style="text-align: left;" data-quarto-table-cell-role="th">statistic</th>
<th class="grt-center grt-vrule-index" style="text-align: left;" data-quarto-table-cell-role="th">A</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">B</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">C</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left" style="text-align: left;">L</td>
<td class="grt-c-1 grt-right grt-vrule-index" style="text-align: left;">13.400</td>
<td class="grt-c-2 grt-right grt-vrule-0" style="text-align: left;">18.300</td>
<td class="grt-c-3 grt-right grt-vrule-0" style="text-align: left;">14.900</td>
<td class="grt-c-4 grt-right grt-vrule-0" style="text-align: left;">46.600</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">a</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">18.613</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">23.810</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">57.577</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">100.0</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">Q</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">4.874</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">5.288</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">36.273</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">46.435</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">P</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">13.739</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">18.522</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">21.304</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">53.565</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">M</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">0.339</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.222</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">6.404</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">6.965</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">COC</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">0.070</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.042</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.177</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.150</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-all-distortion-pricing" style="flex-basis: 100.0%;justify-content: center;">
<div class="greater-table">
<style>
    #TPOWUHACIEAK5  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #TPOWUHACIEAK5 caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #TPOWUHACIEAK5 thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #TPOWUHACIEAK5 tbody {
        
        border-bottom: 1px solid #000;
        }
    #TPOWUHACIEAK5 th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #TPOWUHACIEAK5 td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #TPOWUHACIEAK5 .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #TPOWUHACIEAK5 .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #TPOWUHACIEAK5 .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #TPOWUHACIEAK5 .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #TPOWUHACIEAK5 .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #TPOWUHACIEAK5 .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #TPOWUHACIEAK5 .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #TPOWUHACIEAK5 .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #TPOWUHACIEAK5 .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #TPOWUHACIEAK5 .grt-left {
        text-align: left;
    }
    #TPOWUHACIEAK5 .grt-center {
        text-align: center;
    }
    #TPOWUHACIEAK5 .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #TPOWUHACIEAK5 .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #TPOWUHACIEAK5 .grt-bold {
        font-weight: bold;
    }

</style>

<div id="tbl-all-distortion-pricing-2" class="do-not-create-environment quarto-float quarto-figure quarto-figure-center anchored" data-quarto-postprocess="true">
<figure class="quarto-float quarto-subfloat-tbl figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-all-distortion-pricing-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) PH
</figcaption>
<div aria-describedby="tbl-all-distortion-pricing-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-all-distortion-pricing-2" class="do-not-create-environment caption-top table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" style="text-align: left;" data-quarto-table-cell-role="th">statistic</th>
<th class="grt-center grt-vrule-index" style="text-align: left;" data-quarto-table-cell-role="th">A</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">B</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">C</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left" style="text-align: left;">L</td>
<td class="grt-c-1 grt-right grt-vrule-index" style="text-align: left;">13.400</td>
<td class="grt-c-2 grt-right grt-vrule-0" style="text-align: left;">18.300</td>
<td class="grt-c-3 grt-right grt-vrule-0" style="text-align: left;">14.900</td>
<td class="grt-c-4 grt-right grt-vrule-0" style="text-align: left;">46.600</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">a</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">21.133</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">24.914</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">53.952</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">100.000</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">Q</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">7.074</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">6.565</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">32.796</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">46.435</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">P</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">14.060</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">18.349</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">21.156</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">53.565</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">M</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">0.660</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.049</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">6.256</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">6.965</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">COC</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">0.093</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.008</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.191</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.150</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-all-distortion-pricing" style="flex-basis: 100.0%;justify-content: center;">
<div class="greater-table">
<style>
    #TSQHCI7SJYN25  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #TSQHCI7SJYN25 caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #TSQHCI7SJYN25 thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #TSQHCI7SJYN25 tbody {
        
        border-bottom: 1px solid #000;
        }
    #TSQHCI7SJYN25 th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #TSQHCI7SJYN25 td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #TSQHCI7SJYN25 .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #TSQHCI7SJYN25 .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #TSQHCI7SJYN25 .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #TSQHCI7SJYN25 .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #TSQHCI7SJYN25 .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #TSQHCI7SJYN25 .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #TSQHCI7SJYN25 .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #TSQHCI7SJYN25 .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #TSQHCI7SJYN25 .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #TSQHCI7SJYN25 .grt-left {
        text-align: left;
    }
    #TSQHCI7SJYN25 .grt-center {
        text-align: center;
    }
    #TSQHCI7SJYN25 .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #TSQHCI7SJYN25 .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #TSQHCI7SJYN25 .grt-bold {
        font-weight: bold;
    }

</style>

<div id="tbl-all-distortion-pricing-3" class="do-not-create-environment quarto-float quarto-figure quarto-figure-center anchored" data-quarto-postprocess="true">
<figure class="quarto-float quarto-subfloat-tbl figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-all-distortion-pricing-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Wang
</figcaption>
<div aria-describedby="tbl-all-distortion-pricing-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-all-distortion-pricing-3" class="do-not-create-environment caption-top table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" style="text-align: left;" data-quarto-table-cell-role="th">statistic</th>
<th class="grt-center grt-vrule-index" style="text-align: left;" data-quarto-table-cell-role="th">A</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">B</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">C</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left" style="text-align: left;">L</td>
<td class="grt-c-1 grt-right grt-vrule-index" style="text-align: left;">13.400</td>
<td class="grt-c-2 grt-right grt-vrule-0" style="text-align: left;">18.300</td>
<td class="grt-c-3 grt-right grt-vrule-0" style="text-align: left;">14.900</td>
<td class="grt-c-4 grt-right grt-vrule-0" style="text-align: left;">46.600</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">a</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">22.520</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">27.328</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">50.152</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">100.000</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">Q</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">8.411</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">8.691</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">29.333</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">46.435</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">P</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">14.109</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">18.637</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">20.819</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">53.565</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">M</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">0.709</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.337</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">5.919</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">6.965</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">COC</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">0.084</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.039</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.202</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.150</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-all-distortion-pricing" style="flex-basis: 100.0%;justify-content: center;">
<div class="greater-table">
<style>
    #TAH3J763HHICN  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #TAH3J763HHICN caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #TAH3J763HHICN thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #TAH3J763HHICN tbody {
        
        border-bottom: 1px solid #000;
        }
    #TAH3J763HHICN th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #TAH3J763HHICN td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #TAH3J763HHICN .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #TAH3J763HHICN .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #TAH3J763HHICN .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #TAH3J763HHICN .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #TAH3J763HHICN .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #TAH3J763HHICN .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #TAH3J763HHICN .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #TAH3J763HHICN .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #TAH3J763HHICN .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #TAH3J763HHICN .grt-left {
        text-align: left;
    }
    #TAH3J763HHICN .grt-center {
        text-align: center;
    }
    #TAH3J763HHICN .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #TAH3J763HHICN .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #TAH3J763HHICN .grt-bold {
        font-weight: bold;
    }

</style>

<div id="tbl-all-distortion-pricing-4" class="do-not-create-environment quarto-float quarto-figure quarto-figure-center anchored" data-quarto-postprocess="true">
<figure class="quarto-float quarto-subfloat-tbl figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-all-distortion-pricing-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d) Dual
</figcaption>
<div aria-describedby="tbl-all-distortion-pricing-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-all-distortion-pricing-4" class="do-not-create-environment caption-top table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" style="text-align: left;" data-quarto-table-cell-role="th">statistic</th>
<th class="grt-center grt-vrule-index" style="text-align: left;" data-quarto-table-cell-role="th">A</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">B</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">C</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left" style="text-align: left;">L</td>
<td class="grt-c-1 grt-right grt-vrule-index" style="text-align: left;">13.400</td>
<td class="grt-c-2 grt-right grt-vrule-0" style="text-align: left;">18.300</td>
<td class="grt-c-3 grt-right grt-vrule-0" style="text-align: left;">14.900</td>
<td class="grt-c-4 grt-right grt-vrule-0" style="text-align: left;">46.600</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">a</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">22.999</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">28.260</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">48.741</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">100.0</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">Q</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">8.873</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">9.143</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">28.419</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">46.435</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">P</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">14.127</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">19.117</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">20.322</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">53.565</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">M</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">0.727</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.817</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">5.422</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">6.965</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">COC</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">0.082</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.089</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.191</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.150</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-all-distortion-pricing" style="flex-basis: 100.0%;justify-content: center;">
<div class="greater-table">
<style>
    #T7NNUXDUKGYLU  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #T7NNUXDUKGYLU caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #T7NNUXDUKGYLU thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #T7NNUXDUKGYLU tbody {
        
        border-bottom: 1px solid #000;
        }
    #T7NNUXDUKGYLU th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #T7NNUXDUKGYLU td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #T7NNUXDUKGYLU .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #T7NNUXDUKGYLU .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #T7NNUXDUKGYLU .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #T7NNUXDUKGYLU .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #T7NNUXDUKGYLU .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #T7NNUXDUKGYLU .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #T7NNUXDUKGYLU .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #T7NNUXDUKGYLU .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #T7NNUXDUKGYLU .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #T7NNUXDUKGYLU .grt-left {
        text-align: left;
    }
    #T7NNUXDUKGYLU .grt-center {
        text-align: center;
    }
    #T7NNUXDUKGYLU .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #T7NNUXDUKGYLU .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #T7NNUXDUKGYLU .grt-bold {
        font-weight: bold;
    }

</style>

<div id="tbl-all-distortion-pricing-5" class="do-not-create-environment quarto-float quarto-figure quarto-figure-center anchored" data-quarto-postprocess="true">
<figure class="quarto-float quarto-subfloat-tbl figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-all-distortion-pricing-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(e) TVaR
</figcaption>
<div aria-describedby="tbl-all-distortion-pricing-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-all-distortion-pricing-5" class="do-not-create-environment caption-top table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" style="text-align: left;" data-quarto-table-cell-role="th">statistic</th>
<th class="grt-center grt-vrule-index" style="text-align: left;" data-quarto-table-cell-role="th">A</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">B</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">C</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left" style="text-align: left;">L</td>
<td class="grt-c-1 grt-right grt-vrule-index" style="text-align: left;">13.400</td>
<td class="grt-c-2 grt-right grt-vrule-0" style="text-align: left;">18.300</td>
<td class="grt-c-3 grt-right grt-vrule-0" style="text-align: left;">14.900</td>
<td class="grt-c-4 grt-right grt-vrule-0" style="text-align: left;">46.600</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">a</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">22.817</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">29.659</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">47.525</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">100.000</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">Q</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">9.034</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">9.247</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">28.154</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">46.435</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">P</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">13.783</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">20.412</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">19.371</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">53.565</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">M</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">0.383</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">2.112</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">4.471</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">6.965</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">COC</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">0.042</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.228</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.159</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.150</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</div>
</div>
</figure>
</div>
</section>
<section id="reinsurance-analysis" class="level3" data-number="9.4.3">
<h3 data-number="9.4.3" class="anchored" data-anchor-id="reinsurance-analysis"><span class="header-section-number">9.4.3</span> Reinsurance analysis</h3>
<p><a href="050_Applications.html" class="quarto-xref"><span>Chapter 5</span></a> analyzes a possible 35 xs 65 aggregate stop loss reinsurance contract. The setup to analyze this contract, using a separate <code>Portfolio</code> object, is shown next. The first two lines apply reinsurance; <code>[1, 35, 65]</code> specifies 100% of the 35 xs 65 layer, and <code>c</code> and <code>n</code> are functions mapping gross to ceded and net. The last line creates a new <code>Portfolio</code> object from the net and ceded aggregate losses.</p>
<div id="lstx-setup-re" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a>loss_sample_re <span class="op">=</span> loss_sample.copy()</span>
<span id="cb9-2"><a href="#cb9-2"></a>c, n <span class="op">=</span> make_ceder_netter([(<span class="dv">1</span>, <span class="dv">35</span>, <span class="dv">65</span>)])</span>
<span id="cb9-3"><a href="#cb9-3"></a>loss_sample_re[<span class="st">'Net'</span>] <span class="op">=</span> n(loss_sample_re.total)</span>
<span id="cb9-4"><a href="#cb9-4"></a>loss_sample_re[<span class="st">'Ceded'</span>] <span class="op">=</span> c(loss_sample_re.total)</span>
<span id="cb9-5"><a href="#cb9-5"></a>loss_sample_re <span class="op">=</span> loss_sample_re[[<span class="st">'Net'</span>, <span class="st">'Ceded'</span>, <span class="st">'p_total'</span>]]</span>
<span id="cb9-6"><a href="#cb9-6"></a></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co"># build Portfolio object with Net, Ceded units</span></span>
<span id="cb9-8"><a href="#cb9-8"></a>wport_re <span class="op">=</span> Portfolio.create_from_sample(<span class="st">'WGS3'</span>,</span>
<span id="cb9-9"><a href="#cb9-9"></a>            loss_sample_re[[<span class="st">'Net'</span>, <span class="st">'Ceded'</span>, <span class="st">'p_total'</span>]], bs<span class="op">=</span><span class="dv">1</span>, log2<span class="op">=</span><span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><a href="#tbl-re-object" class="quarto-xref">Table&nbsp;<span>9.9</span></a> shows the standard summary statistics. <!--# In Table 9.9, for consistency, I would capitalize "total" in column 1. --> It should be compared to <a href="050_Applications.html#tbl-events-with-RI" class="quarto-xref">Table&nbsp;<span>5.1</span></a>. <a href="#tbl-all-distortioun-re-pricing" class="quarto-xref">Table&nbsp;<span>9.10</span></a> shows the allocated pricing to the reinsurance and net across the five standard distortions, compare with the last row of <a href="050_Applications.html#tbl-events-with-RI" class="quarto-xref">Table&nbsp;<span>5.1</span></a> and discussion in <a href="050_Applications.html#sec-Reinsurance-decision-making" class="quarto-xref"><span>Section 5.2</span></a>. <!--# In Table 9.10, recommend capitalizing "total" in the far right column of the header row. --></p>
<div class="cell" data-execution_count="18">
<div id="tbl-re-object" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="18">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-re-object-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9.9: Summary statistics created by the reinsurance Portfolio object.
</figcaption>
<div aria-describedby="tbl-re-object-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="17">
<div class="greater-table">
<style>
    #TWOC5NBT3WVH3  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #TWOC5NBT3WVH3 caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #TWOC5NBT3WVH3 thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #TWOC5NBT3WVH3 tbody {
        
        border-bottom: 1px solid #000;
        }
    #TWOC5NBT3WVH3 th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #TWOC5NBT3WVH3 td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #TWOC5NBT3WVH3 .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #TWOC5NBT3WVH3 .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #TWOC5NBT3WVH3 .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #TWOC5NBT3WVH3 .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #TWOC5NBT3WVH3 .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #TWOC5NBT3WVH3 .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #TWOC5NBT3WVH3 .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #TWOC5NBT3WVH3 .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #TWOC5NBT3WVH3 .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #TWOC5NBT3WVH3 .grt-left {
        text-align: left;
    }
    #TWOC5NBT3WVH3 .grt-center {
        text-align: center;
    }
    #TWOC5NBT3WVH3 .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #TWOC5NBT3WVH3 .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #TWOC5NBT3WVH3 .grt-bold {
        font-weight: bold;
    }

</style>

<table id="TWOC5NBT3WVH3" class="do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" data-quarto-table-cell-role="th">unit</th>
<th class="grt-left" data-quarto-table-cell-role="th">X</th>
<th class="grt-center grt-vrule-index" data-quarto-table-cell-role="th">E[X]</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">Est E[X]</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">CV(X)</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">Est CV(X)</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">Skew(X)</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">Est Skew(X)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left">Net</td>
<td class="grt-c-1 grt-left">Freq</td>
<td class="grt-c-2 grt-right grt-vrule-index">1</td>
<td class="grt-c-3 grt-right grt-vrule-0"></td>
<td class="grt-c-4 grt-right grt-vrule-0">0</td>
<td class="grt-c-5 grt-right grt-vrule-0"></td>
<td class="grt-c-6 grt-right grt-vrule-0"></td>
<td class="grt-c-7 grt-right grt-vrule-0"></td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Sev</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">43.1</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">43.100</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">0.317</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0">0.317</td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">0.369</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0">0.369</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Agg</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">43.1</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">43.100</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">0.317</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0">0.317</td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">0.369</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0">0.369</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0">Ceded</td>
<td class="grt-c-1 grt-left grt-hrule-0">Freq</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-index">1</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0"></td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0">0</td>
<td class="grt-c-5 grt-right grt-hrule-0 grt-vrule-0"></td>
<td class="grt-c-6 grt-right grt-hrule-0 grt-vrule-0"></td>
<td class="grt-c-7 grt-right grt-hrule-0 grt-vrule-0"></td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Sev</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">3.5</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">3.500</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">3</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0">3.000</td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">2.667</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0">2.667</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Agg</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">3.5</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">3.500</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">3</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0">3.000</td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">2.667</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0">2.667</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0">total</td>
<td class="grt-c-1 grt-left grt-hrule-0">Freq</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-index">2</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0"></td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0">0</td>
<td class="grt-c-5 grt-right grt-hrule-0 grt-vrule-0"></td>
<td class="grt-c-6 grt-right grt-hrule-0 grt-vrule-0"></td>
<td class="grt-c-7 grt-right grt-hrule-0 grt-vrule-0"></td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Sev</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">23.3</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">23.300</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">0.998</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0"></td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">0.340</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0"></td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Agg</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">46.6</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">46.600</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">0.370</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0">0.370</td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">0.788</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0">0.788</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tbl-all-distortioun-re-pricing" class="quarto-layout-panel anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-all-distortioun-re-pricing-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9.10: Pricing by distortion for ceded, net, and total (gross).
</figcaption>
<div aria-describedby="tbl-all-distortioun-re-pricing-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-all-distortioun-re-pricing" style="flex-basis: 100.0%;justify-content: center;">
<div class="greater-table">
<style>
    #TICWBOVEWEDT7  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #TICWBOVEWEDT7 caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #TICWBOVEWEDT7 thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #TICWBOVEWEDT7 tbody {
        
        border-bottom: 1px solid #000;
        }
    #TICWBOVEWEDT7 th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #TICWBOVEWEDT7 td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #TICWBOVEWEDT7 .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #TICWBOVEWEDT7 .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #TICWBOVEWEDT7 .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #TICWBOVEWEDT7 .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #TICWBOVEWEDT7 .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #TICWBOVEWEDT7 .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #TICWBOVEWEDT7 .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #TICWBOVEWEDT7 .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #TICWBOVEWEDT7 .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #TICWBOVEWEDT7 .grt-left {
        text-align: left;
    }
    #TICWBOVEWEDT7 .grt-center {
        text-align: center;
    }
    #TICWBOVEWEDT7 .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #TICWBOVEWEDT7 .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #TICWBOVEWEDT7 .grt-bold {
        font-weight: bold;
    }

</style>

<div id="tbl-all-distortioun-re-pricing-1" class="do-not-create-environment quarto-float quarto-figure quarto-figure-center anchored" data-quarto-postprocess="true">
<figure class="quarto-float quarto-subfloat-tbl figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-all-distortioun-re-pricing-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) CCoC
</figcaption>
<div aria-describedby="tbl-all-distortioun-re-pricing-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-all-distortioun-re-pricing-1" class="do-not-create-environment caption-top table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" style="text-align: left;" data-quarto-table-cell-role="th">statistic</th>
<th class="grt-center grt-vrule-index" style="text-align: left;" data-quarto-table-cell-role="th">Ceded</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">Net</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left" style="text-align: left;">L</td>
<td class="grt-c-1 grt-right grt-vrule-index" style="text-align: left;">3.500</td>
<td class="grt-c-2 grt-right grt-vrule-0" style="text-align: left;">43.100</td>
<td class="grt-c-3 grt-right grt-vrule-0" style="text-align: left;">46.600</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">a</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">30.013</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">69.987</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">100.0</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">Q</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">22.405</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">24.030</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">46.435</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">P</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">7.609</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">45.957</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">53.565</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">M</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">4.109</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">2.857</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">6.965</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">COC</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">0.183</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.119</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.150</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-all-distortioun-re-pricing" style="flex-basis: 100.0%;justify-content: center;">
<div class="greater-table">
<style>
    #T6K3MJZUG4BMW  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #T6K3MJZUG4BMW caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #T6K3MJZUG4BMW thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #T6K3MJZUG4BMW tbody {
        
        border-bottom: 1px solid #000;
        }
    #T6K3MJZUG4BMW th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #T6K3MJZUG4BMW td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #T6K3MJZUG4BMW .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #T6K3MJZUG4BMW .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #T6K3MJZUG4BMW .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #T6K3MJZUG4BMW .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #T6K3MJZUG4BMW .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #T6K3MJZUG4BMW .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #T6K3MJZUG4BMW .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #T6K3MJZUG4BMW .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #T6K3MJZUG4BMW .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #T6K3MJZUG4BMW .grt-left {
        text-align: left;
    }
    #T6K3MJZUG4BMW .grt-center {
        text-align: center;
    }
    #T6K3MJZUG4BMW .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #T6K3MJZUG4BMW .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #T6K3MJZUG4BMW .grt-bold {
        font-weight: bold;
    }

</style>

<div id="tbl-all-distortioun-re-pricing-2" class="do-not-create-environment quarto-float quarto-figure quarto-figure-center anchored" data-quarto-postprocess="true">
<figure class="quarto-float quarto-subfloat-tbl figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-all-distortioun-re-pricing-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) PH
</figcaption>
<div aria-describedby="tbl-all-distortioun-re-pricing-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-all-distortioun-re-pricing-2" class="do-not-create-environment caption-top table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" style="text-align: left;" data-quarto-table-cell-role="th">statistic</th>
<th class="grt-center grt-vrule-index" style="text-align: left;" data-quarto-table-cell-role="th">Ceded</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">Net</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left" style="text-align: left;">L</td>
<td class="grt-c-1 grt-right grt-vrule-index" style="text-align: left;">3.500</td>
<td class="grt-c-2 grt-right grt-vrule-0" style="text-align: left;">43.100</td>
<td class="grt-c-3 grt-right grt-vrule-0" style="text-align: left;">46.600</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">a</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">23.383</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">76.617</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">100.000</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">Q</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">16.721</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">29.714</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">46.435</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">P</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">6.662</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">46.903</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">53.565</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">M</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">3.162</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">3.803</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">6.965</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">COC</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">0.189</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.128</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.150</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-all-distortioun-re-pricing" style="flex-basis: 100.0%;justify-content: center;">
<div class="greater-table">
<style>
    #TMT7IQJZWBUAI  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #TMT7IQJZWBUAI caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #TMT7IQJZWBUAI thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #TMT7IQJZWBUAI tbody {
        
        border-bottom: 1px solid #000;
        }
    #TMT7IQJZWBUAI th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #TMT7IQJZWBUAI td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #TMT7IQJZWBUAI .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #TMT7IQJZWBUAI .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #TMT7IQJZWBUAI .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #TMT7IQJZWBUAI .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #TMT7IQJZWBUAI .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #TMT7IQJZWBUAI .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #TMT7IQJZWBUAI .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #TMT7IQJZWBUAI .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #TMT7IQJZWBUAI .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #TMT7IQJZWBUAI .grt-left {
        text-align: left;
    }
    #TMT7IQJZWBUAI .grt-center {
        text-align: center;
    }
    #TMT7IQJZWBUAI .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #TMT7IQJZWBUAI .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #TMT7IQJZWBUAI .grt-bold {
        font-weight: bold;
    }

</style>

<div id="tbl-all-distortioun-re-pricing-3" class="do-not-create-environment quarto-float quarto-figure quarto-figure-center anchored" data-quarto-postprocess="true">
<figure class="quarto-float quarto-subfloat-tbl figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-all-distortioun-re-pricing-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Wang
</figcaption>
<div aria-describedby="tbl-all-distortioun-re-pricing-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-all-distortioun-re-pricing-3" class="do-not-create-environment caption-top table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" style="text-align: left;" data-quarto-table-cell-role="th">statistic</th>
<th class="grt-center grt-vrule-index" style="text-align: left;" data-quarto-table-cell-role="th">Ceded</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">Net</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left" style="text-align: left;">L</td>
<td class="grt-c-1 grt-right grt-vrule-index" style="text-align: left;">3.500</td>
<td class="grt-c-2 grt-right grt-vrule-0" style="text-align: left;">43.100</td>
<td class="grt-c-3 grt-right grt-vrule-0" style="text-align: left;">46.600</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">a</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">20.237</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">79.763</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">100.000</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">Q</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">14.150</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">32.284</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">46.435</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">P</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">6.087</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">47.478</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">53.565</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">M</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">2.587</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">4.378</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">6.965</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">COC</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">0.183</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.136</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.150</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-all-distortioun-re-pricing" style="flex-basis: 100.0%;justify-content: center;">
<div class="greater-table">
<style>
    #TYNGAGDIEOFCI  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #TYNGAGDIEOFCI caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #TYNGAGDIEOFCI thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #TYNGAGDIEOFCI tbody {
        
        border-bottom: 1px solid #000;
        }
    #TYNGAGDIEOFCI th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #TYNGAGDIEOFCI td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #TYNGAGDIEOFCI .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #TYNGAGDIEOFCI .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #TYNGAGDIEOFCI .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #TYNGAGDIEOFCI .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #TYNGAGDIEOFCI .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #TYNGAGDIEOFCI .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #TYNGAGDIEOFCI .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #TYNGAGDIEOFCI .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #TYNGAGDIEOFCI .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #TYNGAGDIEOFCI .grt-left {
        text-align: left;
    }
    #TYNGAGDIEOFCI .grt-center {
        text-align: center;
    }
    #TYNGAGDIEOFCI .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #TYNGAGDIEOFCI .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #TYNGAGDIEOFCI .grt-bold {
        font-weight: bold;
    }

</style>

<div id="tbl-all-distortioun-re-pricing-4" class="do-not-create-environment quarto-float quarto-figure quarto-figure-center anchored" data-quarto-postprocess="true">
<figure class="quarto-float quarto-subfloat-tbl figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-all-distortioun-re-pricing-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d) Dual
</figcaption>
<div aria-describedby="tbl-all-distortioun-re-pricing-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-all-distortioun-re-pricing-4" class="do-not-create-environment caption-top table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" style="text-align: left;" data-quarto-table-cell-role="th">statistic</th>
<th class="grt-center grt-vrule-index" style="text-align: left;" data-quarto-table-cell-role="th">Ceded</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">Net</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left" style="text-align: left;">L</td>
<td class="grt-c-1 grt-right grt-vrule-index" style="text-align: left;">3.500</td>
<td class="grt-c-2 grt-right grt-vrule-0" style="text-align: left;">43.100</td>
<td class="grt-c-3 grt-right grt-vrule-0" style="text-align: left;">46.600</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">a</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">18.539</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">81.461</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">100.0</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">Q</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">13.125</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">33.310</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">46.435</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">P</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">5.415</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">48.151</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">53.565</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">M</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">1.915</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">5.051</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">6.965</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">COC</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">0.146</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.152</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.150</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-all-distortioun-re-pricing" style="flex-basis: 100.0%;justify-content: center;">
<div class="greater-table">
<style>
    #T5Q4GTB2L7JXR  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #T5Q4GTB2L7JXR caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #T5Q4GTB2L7JXR thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #T5Q4GTB2L7JXR tbody {
        
        border-bottom: 1px solid #000;
        }
    #T5Q4GTB2L7JXR th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #T5Q4GTB2L7JXR td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #T5Q4GTB2L7JXR .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #T5Q4GTB2L7JXR .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #T5Q4GTB2L7JXR .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #T5Q4GTB2L7JXR .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #T5Q4GTB2L7JXR .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #T5Q4GTB2L7JXR .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #T5Q4GTB2L7JXR .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #T5Q4GTB2L7JXR .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #T5Q4GTB2L7JXR .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #T5Q4GTB2L7JXR .grt-left {
        text-align: left;
    }
    #T5Q4GTB2L7JXR .grt-center {
        text-align: center;
    }
    #T5Q4GTB2L7JXR .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #T5Q4GTB2L7JXR .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #T5Q4GTB2L7JXR .grt-bold {
        font-weight: bold;
    }

</style>

<div id="tbl-all-distortioun-re-pricing-5" class="do-not-create-environment quarto-float quarto-figure quarto-figure-center anchored" data-quarto-postprocess="true">
<figure class="quarto-float quarto-subfloat-tbl figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-all-distortioun-re-pricing-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(e) TVaR
</figcaption>
<div aria-describedby="tbl-all-distortioun-re-pricing-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-all-distortioun-re-pricing-5" class="do-not-create-environment caption-top table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" style="text-align: left;" data-quarto-table-cell-role="th">statistic</th>
<th class="grt-center grt-vrule-index" style="text-align: left;" data-quarto-table-cell-role="th">Ceded</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">Net</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left" style="text-align: left;">L</td>
<td class="grt-c-1 grt-right grt-vrule-index" style="text-align: left;">3.500</td>
<td class="grt-c-2 grt-right grt-vrule-0" style="text-align: left;">43.100</td>
<td class="grt-c-3 grt-right grt-vrule-0" style="text-align: left;">46.600</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">a</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">17.679</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">82.321</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">100.000</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">Q</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">12.876</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">33.559</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">46.435</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">P</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">4.803</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">48.762</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">53.565</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">M</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">1.303</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">5.662</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">6.965</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">COC</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">0.101</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.169</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.150</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</div>
</div>
</figure>
</div>
</section>
</section>
<section id="sec-realistic" class="level2" data-number="9.5">
<h2 data-number="9.5" class="anchored" data-anchor-id="sec-realistic"><span class="header-section-number">9.5</span> A more realistic example</h2>
<p>In this section, we create a series of exhibits analogous to those in <a href="#sec-sde" class="quarto-xref"><span>Section 9.4</span></a> for an example with more realistic assumptions. It is included to show how <code>aggregate</code> can be used to solve real-world problems, hopefully motivating you to explore it further. The analysis steps are:</p>
<ol type="1">
<li>Create realistic by-unit frequency and severity distributions using Fast Fourier Transforms with independent units.</li>
<li>Sample the unit distributions with correlation induced by Iman-Conover, <a href="070_AdvancedTopics.html#sec-iman-conover" class="quarto-xref"><span>Section 8.2</span></a>.</li>
<li>Build a <code>Portfolio</code> from the correlated sample.</li>
<li>Calibrate distortions and compute unit pricing for each distortion.</li>
<li>Apply by-unit, per-occurrence reinsurance and examine pricing impact.</li>
</ol>
<p>The <code>aggregate</code> DecL programming language makes it easy to specify frequency-severity compound distributions. In the code chunk below, the four lines inside the <code>build</code> statement are the DecL program. The triple quotes are Python shorthand for entering a multiline string. The first program line, beginning <code>agg Auto</code>, creates a distribution with an expected loss of 5000 (think: losses in 000s), severity from the 5000 xs 0 layer of a lognormal variable with a mean of 50 and a CV of 2, and gamma mixed-Poisson frequency with a mixing parameter (CV) of 0.2. The other two lines are analogous. The <code>build</code> statement runs the DecL program and creates a <code>Portfolio</code> object with relevant compound distributions by unit. It also sums the unit distributions as though they were independent—we will introduce some correlation later.</p>
<div id="lstx-univariates-0" class="cell" data-execution_count="20">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a><span class="im">from</span> aggregate <span class="im">import</span> build</span>
<span id="cb10-2"><a href="#cb10-2"></a>port <span class="op">=</span> build(<span class="st">"""</span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="st">port Units</span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="st">    agg Auto 5000 loss  5000 xs 0 sev lognorm 50 cv  2 mixed gamma 0.2</span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="st">    agg GL   3000 loss  2500 xs 0 sev lognorm 75 cv  3 mixed gamma 0.3</span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="st">    agg WC   7000 loss 25000 xs 0 sev lognorm  5 cv 10 mixed gamma 0.25</span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><a href="#tbl-univariates-1" class="quarto-xref">Table&nbsp;<span>9.11</span></a> shows the by-unit frequency and severity statistics and the total statistics assuming the units are independent. The deviation between the Fast Fourier Transform-generated compound distributions and the requested specifications are negligible. <a href="#fig-univariates" class="quarto-xref">Figure&nbsp;<span>9.2</span></a> plots the unit and total densities on a nominal and log scale. The effect of WC driving the tail, via thicker severity and higher occurrence limit, is clear on the log plot. <!--# In Table 9.11, recommend capitalizing "Total." --></p>
<div class="cell" data-execution_count="21">
<div id="tbl-univariates-1" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="21">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-univariates-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9.11: Unit frequency, severity and compound assumptions, and portfolio total, showing requested and model achieved and key statistics.
</figcaption>
<div aria-describedby="tbl-univariates-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="20">
<div class="greater-table">
<style>
    #TEB2526VQUAFN  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #TEB2526VQUAFN caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #TEB2526VQUAFN thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #TEB2526VQUAFN tbody {
        
        border-bottom: 1px solid #000;
        }
    #TEB2526VQUAFN th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #TEB2526VQUAFN td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #TEB2526VQUAFN .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #TEB2526VQUAFN .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #TEB2526VQUAFN .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #TEB2526VQUAFN .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #TEB2526VQUAFN .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #TEB2526VQUAFN .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #TEB2526VQUAFN .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #TEB2526VQUAFN .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #TEB2526VQUAFN .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #TEB2526VQUAFN .grt-left {
        text-align: left;
    }
    #TEB2526VQUAFN .grt-center {
        text-align: center;
    }
    #TEB2526VQUAFN .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #TEB2526VQUAFN .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #TEB2526VQUAFN .grt-bold {
        font-weight: bold;
    }

</style>

<table id="TEB2526VQUAFN" class="do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" data-quarto-table-cell-role="th">unit</th>
<th class="grt-left" data-quarto-table-cell-role="th">X</th>
<th class="grt-center grt-vrule-index" data-quarto-table-cell-role="th">E[X]</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">Est E[X]</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">CV(X)</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">Est CV(X)</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">Skew(X)</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">Est Skew(X)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left">Auto</td>
<td class="grt-c-1 grt-left">Freq</td>
<td class="grt-c-2 grt-right grt-vrule-index">100.0</td>
<td class="grt-c-3 grt-right grt-vrule-0">0</td>
<td class="grt-c-4 grt-right grt-vrule-0">0.224</td>
<td class="grt-c-5 grt-right grt-vrule-0">0</td>
<td class="grt-c-6 grt-right grt-vrule-0">0.402</td>
<td class="grt-c-7 grt-right grt-vrule-0">0</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Sev</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">49.982</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">49.982</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">1.973</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0">1.973</td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">10.678</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0">10.678</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Agg</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">5,000</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">5000.0</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">0.298</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0">0.298</td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">0.699</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0">0.699</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0">GL</td>
<td class="grt-c-1 grt-left grt-hrule-0">Freq</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-index">41.008</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0">0</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0">0.338</td>
<td class="grt-c-5 grt-right grt-hrule-0 grt-vrule-0">0</td>
<td class="grt-c-6 grt-right grt-hrule-0 grt-vrule-0">0.604</td>
<td class="grt-c-7 grt-right grt-hrule-0 grt-vrule-0">0</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Sev</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">73.156</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">73.156</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">2.377</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0">2.378</td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">7.385</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0">7.385</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Agg</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">3,000</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">3000.0</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">0.502</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0">0.502</td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">1.024</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0">1.024</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0">WC</td>
<td class="grt-c-1 grt-left grt-hrule-0">Freq</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-index">1401.1</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0">0</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0">0.251</td>
<td class="grt-c-5 grt-right grt-hrule-0 grt-vrule-0">0</td>
<td class="grt-c-6 grt-right grt-hrule-0 grt-vrule-0">0.500</td>
<td class="grt-c-7 grt-right grt-hrule-0 grt-vrule-0">0</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Sev</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">4.996</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">4.945</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">9.103</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0">9.198</td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">147.9</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0">147.9</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Agg</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">7,000</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">7000.0</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">0.350</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0">0.350</td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">1.776</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0">1.775</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0">total</td>
<td class="grt-c-1 grt-left grt-hrule-0">Freq</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-index">1542.1</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0">0</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0">0.229</td>
<td class="grt-c-5 grt-right grt-hrule-0 grt-vrule-0">0</td>
<td class="grt-c-6 grt-right grt-hrule-0 grt-vrule-0">0.496</td>
<td class="grt-c-7 grt-right grt-hrule-0 grt-vrule-0">0</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Sev</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">9.727</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">9.681</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">6.123</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0">0</td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">68.886</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0">0</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Agg</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">15,000</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">15000.0</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">0.216</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0">0.216</td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">0.939</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0">0.938</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="cell-fig-univariates" class="cell" data-execution_count="22">
<div class="cell-output cell-output-display">
<div id="fig-univariates" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-univariates-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="080_Calculations_files/figure-html/fig-univariates-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;9.2: By-unit loss densities (left) and logdensities (right)."><img src="080_Calculations_files/figure-html/fig-univariates-output-1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-univariates-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.2: By-unit loss densities (left) and logdensities (right).
</figcaption>
</figure>
</div>
</div>
</div>
<p>Next, we sample from the unit distributions and shuffle using Iman-Conover to achieve the desired correlation shown in <a href="#tbl-correl" class="quarto-xref">Table&nbsp;<span>9.12</span></a>. This matrix comes from a separate analysis. The revised statistics (note higher total CV), quantiles, and achieved correlation are shown in <a href="#tbl-stats-sample" class="quarto-xref">Table&nbsp;<span>9.13</span></a> and <a href="#tbl-correl-sample" class="quarto-xref">Table&nbsp;<span>9.14</span></a>. <!--# In Table 9.14, recommend capitalizing "Total." --></p>
<div class="cell" data-execution_count="23">
<div id="tbl-correl" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="23">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-correl-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9.12: Desired correlation matrix, as input to Iman-Conover.
</figcaption>
<div aria-describedby="tbl-correl-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="22">
<div class="greater-table">
<style>
    #TLZMAUATOJODR  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #TLZMAUATOJODR caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #TLZMAUATOJODR thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #TLZMAUATOJODR tbody {
        
        border-bottom: 1px solid #000;
        }
    #TLZMAUATOJODR th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #TLZMAUATOJODR td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #TLZMAUATOJODR .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #TLZMAUATOJODR .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #TLZMAUATOJODR .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #TLZMAUATOJODR .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #TLZMAUATOJODR .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #TLZMAUATOJODR .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #TLZMAUATOJODR .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #TLZMAUATOJODR .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #TLZMAUATOJODR .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #TLZMAUATOJODR .grt-left {
        text-align: left;
    }
    #TLZMAUATOJODR .grt-center {
        text-align: center;
    }
    #TLZMAUATOJODR .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #TLZMAUATOJODR .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #TLZMAUATOJODR .grt-bold {
        font-weight: bold;
    }

</style>

<table id="TLZMAUATOJODR" class="do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" data-quarto-table-cell-role="th">index</th>
<th class="grt-center grt-vrule-index" data-quarto-table-cell-role="th">Auto</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">GL</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">WC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left">Auto</td>
<td class="grt-c-1 grt-right grt-vrule-index">1</td>
<td class="grt-c-2 grt-right grt-vrule-0">0.5</td>
<td class="grt-c-3 grt-right grt-vrule-0">0.4</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left">GL</td>
<td class="grt-c-1 grt-right grt-vrule-index">0.5</td>
<td class="grt-c-2 grt-right grt-vrule-0">1</td>
<td class="grt-c-3 grt-right grt-vrule-0">0.1</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left">WC</td>
<td class="grt-c-1 grt-right grt-vrule-index">0.4</td>
<td class="grt-c-2 grt-right grt-vrule-0">0.1</td>
<td class="grt-c-3 grt-right grt-vrule-0">1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-execution_count="24">
<div id="tbl-stats-sample" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="24">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-stats-sample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9.13: Key statistics from sample with Iman-Conover induced correlation.
</figcaption>
<div aria-describedby="tbl-stats-sample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<div class="greater-table">
<style>
    #TPCKQWC6DSPK5  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #TPCKQWC6DSPK5 caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #TPCKQWC6DSPK5 thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #TPCKQWC6DSPK5 tbody {
        
        border-bottom: 1px solid #000;
        }
    #TPCKQWC6DSPK5 th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #TPCKQWC6DSPK5 td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #TPCKQWC6DSPK5 .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #TPCKQWC6DSPK5 .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #TPCKQWC6DSPK5 .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #TPCKQWC6DSPK5 .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #TPCKQWC6DSPK5 .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #TPCKQWC6DSPK5 .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #TPCKQWC6DSPK5 .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #TPCKQWC6DSPK5 .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #TPCKQWC6DSPK5 .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #TPCKQWC6DSPK5 .grt-left {
        text-align: left;
    }
    #TPCKQWC6DSPK5 .grt-center {
        text-align: center;
    }
    #TPCKQWC6DSPK5 .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #TPCKQWC6DSPK5 .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #TPCKQWC6DSPK5 .grt-bold {
        font-weight: bold;
    }

</style>

<table id="TPCKQWC6DSPK5" class="do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" data-quarto-table-cell-role="th">index</th>
<th class="grt-center grt-vrule-index" data-quarto-table-cell-role="th">Auto</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">GL</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">WC</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left">count</td>
<td class="grt-c-1 grt-right grt-vrule-index">1,000</td>
<td class="grt-c-2 grt-right grt-vrule-0">1,000</td>
<td class="grt-c-3 grt-right grt-vrule-0">1,000</td>
<td class="grt-c-4 grt-right grt-vrule-0">1,000</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left">mean</td>
<td class="grt-c-1 grt-right grt-vrule-index">5071.0</td>
<td class="grt-c-2 grt-right grt-vrule-0">3020.2</td>
<td class="grt-c-3 grt-right grt-vrule-0">6970.5</td>
<td class="grt-c-4 grt-right grt-vrule-0">15061.7</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left">std</td>
<td class="grt-c-1 grt-right grt-vrule-index">1508.4</td>
<td class="grt-c-2 grt-right grt-vrule-0">1533.0</td>
<td class="grt-c-3 grt-right grt-vrule-0">2354.5</td>
<td class="grt-c-4 grt-right grt-vrule-0">3985.2</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left">min</td>
<td class="grt-c-1 grt-right grt-vrule-index">1,434</td>
<td class="grt-c-2 grt-right grt-vrule-0">269</td>
<td class="grt-c-3 grt-right grt-vrule-0">3,381</td>
<td class="grt-c-4 grt-right grt-vrule-0">6,707</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left">25%</td>
<td class="grt-c-1 grt-right grt-vrule-index">3,963</td>
<td class="grt-c-2 grt-right grt-vrule-0">1903.8</td>
<td class="grt-c-3 grt-right grt-vrule-0">5,311</td>
<td class="grt-c-4 grt-right grt-vrule-0">12193.2</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left">50%</td>
<td class="grt-c-1 grt-right grt-vrule-index">4894.5</td>
<td class="grt-c-2 grt-right grt-vrule-0">2,705</td>
<td class="grt-c-3 grt-right grt-vrule-0">6,427</td>
<td class="grt-c-4 grt-right grt-vrule-0">14617.5</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left">75%</td>
<td class="grt-c-1 grt-right grt-vrule-index">6000.2</td>
<td class="grt-c-2 grt-right grt-vrule-0">3826.2</td>
<td class="grt-c-3 grt-right grt-vrule-0">8012.8</td>
<td class="grt-c-4 grt-right grt-vrule-0">17382.2</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left">max</td>
<td class="grt-c-1 grt-right grt-vrule-index">10,877</td>
<td class="grt-c-2 grt-right grt-vrule-0">10,321</td>
<td class="grt-c-3 grt-right grt-vrule-0">23,271</td>
<td class="grt-c-4 grt-right grt-vrule-0">39,588</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left">CV</td>
<td class="grt-c-1 grt-right grt-vrule-index">0.297</td>
<td class="grt-c-2 grt-right grt-vrule-0">0.508</td>
<td class="grt-c-3 grt-right grt-vrule-0">0.338</td>
<td class="grt-c-4 grt-right grt-vrule-0">0.265</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-execution_count="25">
<div id="tbl-correl-sample" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="25">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-correl-sample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9.14: Achived between-unit correlation.
</figcaption>
<div aria-describedby="tbl-correl-sample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="24">
<div class="greater-table">
<style>
    #T6UPL42OHOKCQ  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #T6UPL42OHOKCQ caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #T6UPL42OHOKCQ thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #T6UPL42OHOKCQ tbody {
        
        border-bottom: 1px solid #000;
        }
    #T6UPL42OHOKCQ th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #T6UPL42OHOKCQ td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #T6UPL42OHOKCQ .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #T6UPL42OHOKCQ .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #T6UPL42OHOKCQ .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #T6UPL42OHOKCQ .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #T6UPL42OHOKCQ .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #T6UPL42OHOKCQ .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #T6UPL42OHOKCQ .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #T6UPL42OHOKCQ .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #T6UPL42OHOKCQ .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #T6UPL42OHOKCQ .grt-left {
        text-align: left;
    }
    #T6UPL42OHOKCQ .grt-center {
        text-align: center;
    }
    #T6UPL42OHOKCQ .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #T6UPL42OHOKCQ .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #T6UPL42OHOKCQ .grt-bold {
        font-weight: bold;
    }

</style>

<table id="T6UPL42OHOKCQ" class="do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" data-quarto-table-cell-role="th">index</th>
<th class="grt-center grt-vrule-index" data-quarto-table-cell-role="th">Auto</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">GL</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">WC</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left">Auto</td>
<td class="grt-c-1 grt-right grt-vrule-index">1</td>
<td class="grt-c-2 grt-right grt-vrule-0">0.475</td>
<td class="grt-c-3 grt-right grt-vrule-0">0.390</td>
<td class="grt-c-4 grt-right grt-vrule-0">0.792</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left">GL</td>
<td class="grt-c-1 grt-right grt-vrule-index">0.482</td>
<td class="grt-c-2 grt-right grt-vrule-0">1</td>
<td class="grt-c-3 grt-right grt-vrule-0">0.103</td>
<td class="grt-c-4 grt-right grt-vrule-0">0.626</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left">WC</td>
<td class="grt-c-1 grt-right grt-vrule-index">0.386</td>
<td class="grt-c-2 grt-right grt-vrule-0">0.097</td>
<td class="grt-c-3 grt-right grt-vrule-0">1</td>
<td class="grt-c-4 grt-right grt-vrule-0">0.778</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left">total</td>
<td class="grt-c-1 grt-right grt-vrule-index">0.798</td>
<td class="grt-c-2 grt-right grt-vrule-0">0.631</td>
<td class="grt-c-3 grt-right grt-vrule-0">0.732</td>
<td class="grt-c-4 grt-right grt-vrule-0">1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<p><a href="#tbl-univariates-corr" class="quarto-xref">Table&nbsp;<span>9.15</span></a> shows the output of using the correlated sample to build a <code>Portfolio</code> object. <!--# In Table 9.15, recommend capitalizing "Total."  -->This uses the samples directly, proxying the aggregate loss as a compound with degenerate frequency distribution identically equal to one and severity equal to the desired distribution. Hence the frequency rows show expectation one with zero CV.</p>
<div class="cell" data-execution_count="26">
<div id="tbl-univariates-corr" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="26">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-univariates-corr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9.15: Portfolio statistics reflecting the correlation achieved by the Iman-Conover sample.
</figcaption>
<div aria-describedby="tbl-univariates-corr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="25">
<div class="greater-table">
<style>
    #TCALO7V5POWO7  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #TCALO7V5POWO7 caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #TCALO7V5POWO7 thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #TCALO7V5POWO7 tbody {
        
        border-bottom: 1px solid #000;
        }
    #TCALO7V5POWO7 th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #TCALO7V5POWO7 td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #TCALO7V5POWO7 .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #TCALO7V5POWO7 .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #TCALO7V5POWO7 .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #TCALO7V5POWO7 .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #TCALO7V5POWO7 .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #TCALO7V5POWO7 .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #TCALO7V5POWO7 .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #TCALO7V5POWO7 .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #TCALO7V5POWO7 .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #TCALO7V5POWO7 .grt-left {
        text-align: left;
    }
    #TCALO7V5POWO7 .grt-center {
        text-align: center;
    }
    #TCALO7V5POWO7 .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #TCALO7V5POWO7 .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #TCALO7V5POWO7 .grt-bold {
        font-weight: bold;
    }

</style>

<table id="TCALO7V5POWO7" class="do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" data-quarto-table-cell-role="th">unit</th>
<th class="grt-left" data-quarto-table-cell-role="th">X</th>
<th class="grt-center grt-vrule-index" data-quarto-table-cell-role="th">E[X]</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">Est E[X]</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">CV(X)</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">Est CV(X)</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">Skew(X)</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">Est Skew(X)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left">Auto</td>
<td class="grt-c-1 grt-left">Freq</td>
<td class="grt-c-2 grt-right grt-vrule-index">1</td>
<td class="grt-c-3 grt-right grt-vrule-0"></td>
<td class="grt-c-4 grt-right grt-vrule-0">0</td>
<td class="grt-c-5 grt-right grt-vrule-0"></td>
<td class="grt-c-6 grt-right grt-vrule-0"></td>
<td class="grt-c-7 grt-right grt-vrule-0"></td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Sev</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">5071.0</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">5071.0</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">0.297</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0">0.297</td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">0.540</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0">0.540</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Agg</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">5071.0</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">5071.0</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">0.297</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0">0.297</td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">0.540</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0">0.540</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0">GL</td>
<td class="grt-c-1 grt-left grt-hrule-0">Freq</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-index">1</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0"></td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0">0</td>
<td class="grt-c-5 grt-right grt-hrule-0 grt-vrule-0"></td>
<td class="grt-c-6 grt-right grt-hrule-0 grt-vrule-0"></td>
<td class="grt-c-7 grt-right grt-hrule-0 grt-vrule-0"></td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Sev</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">3020.2</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">3020.2</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">0.507</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0">0.507</td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">0.974</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0">0.974</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Agg</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">3020.2</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">3020.2</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">0.507</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0">0.507</td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">0.974</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0">0.974</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0">WC</td>
<td class="grt-c-1 grt-left grt-hrule-0">Freq</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-index">1</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0"></td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0">0</td>
<td class="grt-c-5 grt-right grt-hrule-0 grt-vrule-0"></td>
<td class="grt-c-6 grt-right grt-hrule-0 grt-vrule-0"></td>
<td class="grt-c-7 grt-right grt-hrule-0 grt-vrule-0"></td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Sev</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">6970.5</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">6970.5</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">0.338</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0">0.338</td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">1.620</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0">1.620</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Agg</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">6970.5</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">6970.5</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">0.338</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0">0.338</td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">1.620</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0">1.620</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0">total</td>
<td class="grt-c-1 grt-left grt-hrule-0">Freq</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-index">3</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0"></td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0">0</td>
<td class="grt-c-5 grt-right grt-hrule-0 grt-vrule-0"></td>
<td class="grt-c-6 grt-right grt-hrule-0 grt-vrule-0"></td>
<td class="grt-c-7 grt-right grt-hrule-0 grt-vrule-0"></td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Sev</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">5020.6</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">5020.6</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">0.487</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0"></td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">1.013</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0"></td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left"></td>
<td class="grt-c-1 grt-left grt-hrule-1">Agg</td>
<td class="grt-c-2 grt-right grt-hrule-1 grt-vrule-index">15061.7</td>
<td class="grt-c-3 grt-right grt-hrule-1 grt-vrule-0">15061.7</td>
<td class="grt-c-4 grt-right grt-hrule-1 grt-vrule-0">0.212</td>
<td class="grt-c-5 grt-right grt-hrule-1 grt-vrule-0">0.212</td>
<td class="grt-c-6 grt-right grt-hrule-1 grt-vrule-0">0.818</td>
<td class="grt-c-7 grt-right grt-hrule-1 grt-vrule-0">0.818</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<p><a href="#tbl-param-d" class="quarto-xref">Table&nbsp;<span>9.16</span></a> shows the parameters for distortions calibrated to achieve an overall 15% return at a 99.5% capital standard. <a href="#fig-distortion-functions-sample" class="quarto-xref">Figure&nbsp;<span>9.3</span></a> plots the distortions and probability adjustment functions, compare this with <a href="#fig-distortion-functions" class="quarto-xref">Figure&nbsp;<span>9.1</span></a>. These distortions are slightly more risk averse (higher parameters except PH, driving higher indicated prices).</p>
<div class="cell" data-execution_count="27">
<div id="tbl-param-d" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="27">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-param-d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9.16: Distortion parameters for to target total return at the regulatory capital standard.
</figcaption>
<div aria-describedby="tbl-param-d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="26">
<div class="greater-table">
<style>
    #TKVT2NGGD6NZU  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #TKVT2NGGD6NZU caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #TKVT2NGGD6NZU thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #TKVT2NGGD6NZU tbody {
        
        border-bottom: 1px solid #000;
        }
    #TKVT2NGGD6NZU th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #TKVT2NGGD6NZU td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #TKVT2NGGD6NZU .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #TKVT2NGGD6NZU .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #TKVT2NGGD6NZU .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #TKVT2NGGD6NZU .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #TKVT2NGGD6NZU .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #TKVT2NGGD6NZU .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #TKVT2NGGD6NZU .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #TKVT2NGGD6NZU .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #TKVT2NGGD6NZU .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #TKVT2NGGD6NZU .grt-left {
        text-align: left;
    }
    #TKVT2NGGD6NZU .grt-center {
        text-align: center;
    }
    #TKVT2NGGD6NZU .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #TKVT2NGGD6NZU .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #TKVT2NGGD6NZU .grt-bold {
        font-weight: bold;
    }

</style>

<table id="TKVT2NGGD6NZU" class="do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" data-quarto-table-cell-role="th">method</th>
<th class="grt-center grt-vrule-index" data-quarto-table-cell-role="th">P</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">param</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left">ccoc</td>
<td class="grt-c-1 grt-right grt-vrule-index">16721.7</td>
<td class="grt-c-2 grt-right grt-vrule-0">0.150</td>
<td class="grt-c-3 grt-right grt-vrule-0">0</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0">ph</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index">16721.7</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0">0.662</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0">-0.000</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0">wang</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index">16721.7</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0">0.420</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0">0.000</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0">dual</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index">16721.7</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0">1.706</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0">-0.000</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0">tvar</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index">16721.7</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0">0.282</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="cell-fig-distortion-functions-sample" class="cell" data-execution_count="28">
<div class="cell-output cell-output-display">
<div id="fig-distortion-functions-sample" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-distortion-functions-sample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="080_Calculations_files/figure-html/fig-distortion-functions-sample-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;9.3: Distortion functions and distortion probability adjustment functions."><img src="080_Calculations_files/figure-html/fig-distortion-functions-sample-output-1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-distortion-functions-sample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.3: Distortion functions and distortion probability adjustment functions.
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#tbl-all-distortion-realistic-pricing" class="quarto-xref">Table&nbsp;<span>9.17</span></a> compares the indicated pricing by unit and distortion. <!--# In Table 9.17, recommend capitalizing "Total" in header row. -->It is computed using exactly the same method described for the simple discrete example. The calculations are easy enough that they can be performed in a spreadsheet, but that is not recommended unless you are very patient. <a href="#tbl-loss-ratios" class="quarto-xref">Table&nbsp;<span>9.18</span></a> shows just the implied loss ratios. The total loss ratios are all the same because the distortions are all calibrated to the same overall total premium. Since WC has the heaviest tail, it gets the lowest target loss ratio under CCoC, which is the most tail-risk averse. In fact, CCoC is so tail-risk averse that GL (which offers some diversification because of the correlation structure) gets a target over 100%. This is typical CCoC behavior—cat is really expensive; everything else is cheaper. The reason is clear when you remember CCoC pricing is just a weighted average of the mean and the max. The other distortions are more reasonable. TVaR and dual are quite similar and focus more on volatility risk. Since all three lines are similarly volatile, it is no surprise their target loss ratios are also similar under this view.</p>
<p>This analysis—and indeed the whole monograph—has ignored several important elements: expenses, taxes, and the time value of money. Expenses are relatively easy to incorporate: acquisition expenses are typically amortized over the policy term, administration expenses span the policy term and claim payout period, and claim expenses can be bundled with losses. Taxes, however, are a Byzantine labyrinth requiring careful modeling at the level of legal entity and country. Their treatment is up to each insurer, and it’s hard to offer even vague general guidance. Finally, time value of money brings real conceptual and computational difficulty (as opposed to the man-made complexity of taxes). It is the quantum gravity of insurance pricing. For some early thoughts, see the forthcoming monograph Pricing Multi-Period Insurance Risk by your intrepid second author. <!--# Is there a prepublication link or something we can place here? Or even an entry in the references? --></p>
<div id="tbl-all-distortion-realistic-pricing" class="quarto-layout-panel anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-all-distortion-realistic-pricing-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9.17: Pricing by distortion.
</figcaption>
<div aria-describedby="tbl-all-distortion-realistic-pricing-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-all-distortion-realistic-pricing" style="flex-basis: 100.0%;justify-content: center;">
<div class="greater-table">
<style>
    #TVE2UUFFLA4SN  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #TVE2UUFFLA4SN caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #TVE2UUFFLA4SN thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #TVE2UUFFLA4SN tbody {
        
        border-bottom: 1px solid #000;
        }
    #TVE2UUFFLA4SN th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #TVE2UUFFLA4SN td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #TVE2UUFFLA4SN .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #TVE2UUFFLA4SN .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #TVE2UUFFLA4SN .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #TVE2UUFFLA4SN .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #TVE2UUFFLA4SN .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #TVE2UUFFLA4SN .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #TVE2UUFFLA4SN .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #TVE2UUFFLA4SN .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #TVE2UUFFLA4SN .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #TVE2UUFFLA4SN .grt-left {
        text-align: left;
    }
    #TVE2UUFFLA4SN .grt-center {
        text-align: center;
    }
    #TVE2UUFFLA4SN .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #TVE2UUFFLA4SN .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #TVE2UUFFLA4SN .grt-bold {
        font-weight: bold;
    }

</style>

<div id="tbl-all-distortion-realistic-pricing-1" class="do-not-create-environment quarto-float quarto-figure quarto-figure-center anchored" data-quarto-postprocess="true">
<figure class="quarto-float quarto-subfloat-tbl figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-all-distortion-realistic-pricing-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) CCoC
</figcaption>
<div aria-describedby="tbl-all-distortion-realistic-pricing-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-all-distortion-realistic-pricing-1" class="do-not-create-environment caption-top table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" style="text-align: left;" data-quarto-table-cell-role="th">statistic</th>
<th class="grt-center grt-vrule-index" style="text-align: left;" data-quarto-table-cell-role="th">Auto</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">GL</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">WC</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left" style="text-align: left;">L</td>
<td class="grt-c-1 grt-right grt-vrule-index" style="text-align: left;">5065.4</td>
<td class="grt-c-2 grt-right grt-vrule-0" style="text-align: left;">3016.4</td>
<td class="grt-c-3 grt-right grt-vrule-0" style="text-align: left;">6957.8</td>
<td class="grt-c-4 grt-right grt-vrule-0" style="text-align: left;">15039.6</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">a</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">6968.9</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">5138.5</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">15828.6</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">27936.0</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">Q</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">1722.6</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">1855.2</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">7636.4</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">11214.3</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">P</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">5246.3</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">3283.3</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">8192.2</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">16721.7</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">M</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">180.8</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">266.9</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">1234.4</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">1682.1</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">COC</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">0.105</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.144</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.162</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.150</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-all-distortion-realistic-pricing" style="flex-basis: 100.0%;justify-content: center;">
<div class="greater-table">
<style>
    #TWAXHK6LBKASK  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #TWAXHK6LBKASK caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #TWAXHK6LBKASK thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #TWAXHK6LBKASK tbody {
        
        border-bottom: 1px solid #000;
        }
    #TWAXHK6LBKASK th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #TWAXHK6LBKASK td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #TWAXHK6LBKASK .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #TWAXHK6LBKASK .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #TWAXHK6LBKASK .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #TWAXHK6LBKASK .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #TWAXHK6LBKASK .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #TWAXHK6LBKASK .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #TWAXHK6LBKASK .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #TWAXHK6LBKASK .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #TWAXHK6LBKASK .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #TWAXHK6LBKASK .grt-left {
        text-align: left;
    }
    #TWAXHK6LBKASK .grt-center {
        text-align: center;
    }
    #TWAXHK6LBKASK .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #TWAXHK6LBKASK .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #TWAXHK6LBKASK .grt-bold {
        font-weight: bold;
    }

</style>

<div id="tbl-all-distortion-realistic-pricing-2" class="do-not-create-environment quarto-float quarto-figure quarto-figure-center anchored" data-quarto-postprocess="true">
<figure class="quarto-float quarto-subfloat-tbl figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-all-distortion-realistic-pricing-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) PH
</figcaption>
<div aria-describedby="tbl-all-distortion-realistic-pricing-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-all-distortion-realistic-pricing-2" class="do-not-create-environment caption-top table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" style="text-align: left;" data-quarto-table-cell-role="th">statistic</th>
<th class="grt-center grt-vrule-index" style="text-align: left;" data-quarto-table-cell-role="th">Auto</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">GL</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">WC</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left" style="text-align: left;">L</td>
<td class="grt-c-1 grt-right grt-vrule-index" style="text-align: left;">5065.4</td>
<td class="grt-c-2 grt-right grt-vrule-0" style="text-align: left;">3016.4</td>
<td class="grt-c-3 grt-right grt-vrule-0" style="text-align: left;">6957.8</td>
<td class="grt-c-4 grt-right grt-vrule-0" style="text-align: left;">15039.6</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">a</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">8655.6</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">5610.8</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">13669.6</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">27936.0</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">Q</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">3141.2</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">2225.1</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">5848.0</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">11214.3</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">P</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">5514.4</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">3385.7</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">7821.6</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">16721.7</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">M</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">449.0</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">369.3</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">863.8</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">1682.1</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">COC</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">0.143</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.166</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.148</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.150</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-all-distortion-realistic-pricing" style="flex-basis: 100.0%;justify-content: center;">
<div class="greater-table">
<style>
    #TER763I6I5H37  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #TER763I6I5H37 caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #TER763I6I5H37 thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #TER763I6I5H37 tbody {
        
        border-bottom: 1px solid #000;
        }
    #TER763I6I5H37 th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #TER763I6I5H37 td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #TER763I6I5H37 .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #TER763I6I5H37 .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #TER763I6I5H37 .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #TER763I6I5H37 .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #TER763I6I5H37 .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #TER763I6I5H37 .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #TER763I6I5H37 .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #TER763I6I5H37 .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #TER763I6I5H37 .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #TER763I6I5H37 .grt-left {
        text-align: left;
    }
    #TER763I6I5H37 .grt-center {
        text-align: center;
    }
    #TER763I6I5H37 .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #TER763I6I5H37 .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #TER763I6I5H37 .grt-bold {
        font-weight: bold;
    }

</style>

<div id="tbl-all-distortion-realistic-pricing-3" class="do-not-create-environment quarto-float quarto-figure quarto-figure-center anchored" data-quarto-postprocess="true">
<figure class="quarto-float quarto-subfloat-tbl figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-all-distortion-realistic-pricing-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Wang
</figcaption>
<div aria-describedby="tbl-all-distortion-realistic-pricing-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-all-distortion-realistic-pricing-3" class="do-not-create-environment caption-top table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" style="text-align: left;" data-quarto-table-cell-role="th">statistic</th>
<th class="grt-center grt-vrule-index" style="text-align: left;" data-quarto-table-cell-role="th">Auto</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">GL</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">WC</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left" style="text-align: left;">L</td>
<td class="grt-c-1 grt-right grt-vrule-index" style="text-align: left;">5065.4</td>
<td class="grt-c-2 grt-right grt-vrule-0" style="text-align: left;">3016.4</td>
<td class="grt-c-3 grt-right grt-vrule-0" style="text-align: left;">6957.8</td>
<td class="grt-c-4 grt-right grt-vrule-0" style="text-align: left;">15039.6</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">a</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">8887.7</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">5637.7</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">13410.6</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">27936.0</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">Q</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">3323.9</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">2218.2</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">5672.2</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">11214.3</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">P</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">5563.9</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">3419.5</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">7738.4</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">16721.7</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">M</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">498.4</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">403.1</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">780.6</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">1682.1</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">COC</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">0.150</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.182</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.138</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.150</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-all-distortion-realistic-pricing" style="flex-basis: 100.0%;justify-content: center;">
<div class="greater-table">
<style>
    #TGWCHYW4R67DV  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #TGWCHYW4R67DV caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #TGWCHYW4R67DV thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #TGWCHYW4R67DV tbody {
        
        border-bottom: 1px solid #000;
        }
    #TGWCHYW4R67DV th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #TGWCHYW4R67DV td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #TGWCHYW4R67DV .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #TGWCHYW4R67DV .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #TGWCHYW4R67DV .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #TGWCHYW4R67DV .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #TGWCHYW4R67DV .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #TGWCHYW4R67DV .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #TGWCHYW4R67DV .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #TGWCHYW4R67DV .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #TGWCHYW4R67DV .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #TGWCHYW4R67DV .grt-left {
        text-align: left;
    }
    #TGWCHYW4R67DV .grt-center {
        text-align: center;
    }
    #TGWCHYW4R67DV .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #TGWCHYW4R67DV .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #TGWCHYW4R67DV .grt-bold {
        font-weight: bold;
    }

</style>

<div id="tbl-all-distortion-realistic-pricing-4" class="do-not-create-environment quarto-float quarto-figure quarto-figure-center anchored" data-quarto-postprocess="true">
<figure class="quarto-float quarto-subfloat-tbl figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-all-distortion-realistic-pricing-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d) Dual
</figcaption>
<div aria-describedby="tbl-all-distortion-realistic-pricing-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-all-distortion-realistic-pricing-4" class="do-not-create-environment caption-top table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" style="text-align: left;" data-quarto-table-cell-role="th">statistic</th>
<th class="grt-center grt-vrule-index" style="text-align: left;" data-quarto-table-cell-role="th">Auto</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">GL</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">WC</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left" style="text-align: left;">L</td>
<td class="grt-c-1 grt-right grt-vrule-index" style="text-align: left;">5065.4</td>
<td class="grt-c-2 grt-right grt-vrule-0" style="text-align: left;">3016.4</td>
<td class="grt-c-3 grt-right grt-vrule-0" style="text-align: left;">6957.8</td>
<td class="grt-c-4 grt-right grt-vrule-0" style="text-align: left;">15039.6</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">a</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">8987.6</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">5679.8</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">13268.6</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">27936.0</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">Q</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">3389.0</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">2235.0</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">5590.3</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">11214.3</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">P</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">5598.5</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">3444.8</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">7678.3</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">16721.7</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">M</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">533.1</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">428.5</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">720.6</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">1682.1</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">COC</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">0.157</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.192</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.129</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.150</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-all-distortion-realistic-pricing" style="flex-basis: 100.0%;justify-content: center;">
<div class="greater-table">
<style>
    #T5KQQIFMPJPFM  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #T5KQQIFMPJPFM caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #T5KQQIFMPJPFM thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #T5KQQIFMPJPFM tbody {
        
        border-bottom: 1px solid #000;
        }
    #T5KQQIFMPJPFM th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #T5KQQIFMPJPFM td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #T5KQQIFMPJPFM .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #T5KQQIFMPJPFM .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #T5KQQIFMPJPFM .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #T5KQQIFMPJPFM .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #T5KQQIFMPJPFM .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #T5KQQIFMPJPFM .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #T5KQQIFMPJPFM .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #T5KQQIFMPJPFM .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #T5KQQIFMPJPFM .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #T5KQQIFMPJPFM .grt-left {
        text-align: left;
    }
    #T5KQQIFMPJPFM .grt-center {
        text-align: center;
    }
    #T5KQQIFMPJPFM .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #T5KQQIFMPJPFM .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #T5KQQIFMPJPFM .grt-bold {
        font-weight: bold;
    }

</style>

<div id="tbl-all-distortion-realistic-pricing-5" class="do-not-create-environment quarto-float quarto-figure quarto-figure-center anchored" data-quarto-postprocess="true">
<figure class="quarto-float quarto-subfloat-tbl figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-all-distortion-realistic-pricing-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(e) TVaR
</figcaption>
<div aria-describedby="tbl-all-distortion-realistic-pricing-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-all-distortion-realistic-pricing-5" class="do-not-create-environment caption-top table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" style="text-align: left;" data-quarto-table-cell-role="th">statistic</th>
<th class="grt-center grt-vrule-index" style="text-align: left;" data-quarto-table-cell-role="th">Auto</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">GL</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">WC</th>
<th class="grt-center grt-vrule-0" style="text-align: left;" data-quarto-table-cell-role="th">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left" style="text-align: left;">L</td>
<td class="grt-c-1 grt-right grt-vrule-index" style="text-align: left;">5065.4</td>
<td class="grt-c-2 grt-right grt-vrule-0" style="text-align: left;">3016.4</td>
<td class="grt-c-3 grt-right grt-vrule-0" style="text-align: left;">6957.8</td>
<td class="grt-c-4 grt-right grt-vrule-0" style="text-align: left;">15039.6</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">a</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">9017.0</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">5680.6</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">13238.3</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">27936.0</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">Q</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">3397.0</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">2232.8</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">5584.5</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">11214.3</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">P</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">5620.0</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">3447.9</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">7653.9</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">16721.7</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">M</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">554.6</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">431.5</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">696.1</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">1682.1</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0" style="text-align: left;">COC</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index" style="text-align: left;">0.163</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.193</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.125</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0" style="text-align: left;">0.150</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</div>
</div>
</figure>
</div>
<div class="cell" data-execution_count="30">
<div id="tbl-loss-ratios" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="30">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-loss-ratios-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9.18: Implied loss ratio by unit by pricing by distortion (extract from previous tables).
</figcaption>
<div aria-describedby="tbl-loss-ratios-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="29">
<div class="greater-table">
<style>
    #TINO5G6REPG45  {
    border-collapse: collapse;
    font-family: "Roboto", "Open Sans Condensed", "Arial", 'Segoe UI', sans-serif;
    font-size: 1.0em;
    width: auto;
    
    margin: 10px auto;
    border: none;
    overflow: auto;
    margin-left: auto;
    margin-right: auto;
    }
    
    
    
    #TINO5G6REPG45 caption {
        padding: 4px 10px 2px 10px;
        font-size: 1.1em;
        text-align: center;
        font-weight: normal;
        caption-side: top;
    }
    #TINO5G6REPG45 thead {
        
        border-top: 1px solid #000;
        border-bottom: 1px solid #000;
        font-size: 1.0em;
        }
    #TINO5G6REPG45 tbody {
        
        border-bottom: 1px solid #000;
        }
    #TINO5G6REPG45 th  {
        vertical-align: bottom;
        padding: 4px 10px 4px 10px;
    }
    #TINO5G6REPG45 td {
        
        padding: 2px 10px 2px 10px;
        vertical-align: top;
    }
    
    #TINO5G6REPG45 .grt-hrule-0 {
        border-top: 0.0px solid #000;
    }
    #TINO5G6REPG45 .grt-hrule-1 {
        border-top: 0.0px solid #000;
    }
    #TINO5G6REPG45 .grt-hrule-2 {
        border-top: 0.0px solid #000;
    }
    
    #TINO5G6REPG45 .grt-bhrule-0 {
        border-bottom: 0.0px solid #000;
    }
    #TINO5G6REPG45 .grt-bhrule-1 {
        border-bottom: 0.0px solid #000;
    }
    #TINO5G6REPG45 .grt-vrule-index {
        border-left: 1px solid #000;
    }
    #TINO5G6REPG45 .grt-vrule-0 {
        border-left: 0.0px solid #000;
    }
    #TINO5G6REPG45 .grt-vrule-1 {
        border-left: 0.0px solid #000;
    }
    #TINO5G6REPG45 .grt-vrule-2 {
        border-left: 0.0px solid #000;
    }
    #TINO5G6REPG45 .grt-left {
        text-align: left;
    }
    #TINO5G6REPG45 .grt-center {
        text-align: center;
    }
    #TINO5G6REPG45 .grt-right {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }
    #TINO5G6REPG45 .grt-head {
        font-family: "Times New Roman", 'Courier New';
        font-size: 1.0em;
    }
    #TINO5G6REPG45 .grt-bold {
        font-weight: bold;
    }

</style>

<table id="TINO5G6REPG45" class="do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="grt-left" data-quarto-table-cell-role="th">Method</th>
<th class="grt-center grt-vrule-index" data-quarto-table-cell-role="th">Auto</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">GL</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">WC</th>
<th class="grt-center grt-vrule-0" data-quarto-table-cell-role="th">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="grt-c-0 grt-left">Dist ccoc</td>
<td class="grt-c-1 grt-right grt-vrule-index">96.6%</td>
<td class="grt-c-2 grt-right grt-vrule-0">91.9%</td>
<td class="grt-c-3 grt-right grt-vrule-0">84.9%</td>
<td class="grt-c-4 grt-right grt-vrule-0">0.899</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0">Dist ph</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index">91.9%</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0">89.1%</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0">89.0%</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0">0.899</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0">Dist wang</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index">91.0%</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0">88.2%</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0">89.9%</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0">0.899</td>
</tr>
<tr class="even">
<td class="grt-c-0 grt-left grt-hrule-0">Dist dual</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index">90.5%</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0">87.6%</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0">90.6%</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0">0.899</td>
</tr>
<tr class="odd">
<td class="grt-c-0 grt-left grt-hrule-0">Dist tvar</td>
<td class="grt-c-1 grt-right grt-hrule-0 grt-vrule-index">90.1%</td>
<td class="grt-c-2 grt-right grt-hrule-0 grt-vrule-0">87.5%</td>
<td class="grt-c-3 grt-right grt-hrule-0 grt-vrule-0">90.9%</td>
<td class="grt-c-4 grt-right grt-hrule-0 grt-vrule-0">0.899</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-Mildenhall2024" class="csl-entry" role="listitem">
Mildenhall, Stephen J. 2024. <span>“<span class="nocase">Aggregate: fast, accurate, and flexible approximation of compound probability distributions</span>.”</span> <em>Annals of Actuarial Science</em>, 1–40. <a href="https://doi.org/10.1017/S1748499524000216">https://doi.org/10.1017/S1748499524000216</a>.
</div>
<div id="ref-PIR" class="csl-entry" role="listitem">
Mildenhall, Stephen J, and John A Major. 2022. <em>Pricing Insurance Risk: Theory and Practice</em>. John Wiley &amp; Sons, Inc.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/cmm\.mynl\.com");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./070_AdvancedTopics.html" class="pagination-link" aria-label="Advanced topics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Advanced topics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./090_EndMatter.html" class="pagination-link" aria-label="Appendices">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Appendices</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb11" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb11-1"><a href="#cb11-1"></a><span class="co">---</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="an">format:</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co">  pdf: default</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co">  html: default</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="an">jupyter:</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co">  jupytext:</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co">    text_representation:</span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co">      extension: .qmd</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co">      format_name: quarto</span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co">      format_version: '1.0'</span></span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="co">      jupytext_version: 1.16.4</span></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="co">  kernelspec:</span></span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="co">    display_name: Python 3 (ipykernel)</span></span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="co">    language: python</span></span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="co">    name: python3</span></span>
<span id="cb11-16"><a href="#cb11-16"></a><span class="co">---</span></span>
<span id="cb11-17"><a href="#cb11-17"></a></span>
<span id="cb11-20"><a href="#cb11-20"></a><span class="in">```{python}</span></span>
<span id="cb11-21"><a href="#cb11-21"></a><span class="co">#| echo: false</span></span>
<span id="cb11-22"><a href="#cb11-22"></a><span class="co">#| label: spacer</span></span>
<span id="cb11-23"><a href="#cb11-23"></a><span class="cf">pass</span></span>
<span id="cb11-24"><a href="#cb11-24"></a><span class="in">```</span></span>
<span id="cb11-25"><a href="#cb11-25"></a></span>
<span id="cb11-26"><a href="#cb11-26"></a><span class="fu"># Calculations with `Aggregate` {#sec-Calcs-with-Aggregate}</span></span>
<span id="cb11-27"><a href="#cb11-27"></a></span>
<span id="cb11-28"><a href="#cb11-28"></a>*Example calculations using Python and R.*</span>
<span id="cb11-29"><a href="#cb11-29"></a></span>
<span id="cb11-30"><a href="#cb11-30"></a>This chapter reproduces many of the exhibits from the main text using Python and the <span class="in">`aggregate`</span> package. It also describes how to extend to more realistic examples. Throughout, we have included only terse subsets of code so the reader can focus on the results and the output. Instructions for obtaining the full code are provided below.</span>
<span id="cb11-31"><a href="#cb11-31"></a></span>
<span id="cb11-32"><a href="#cb11-32"></a><span class="fu">## `Aggregate` and Python</span></span>
<span id="cb11-33"><a href="#cb11-33"></a></span>
<span id="cb11-34"><a href="#cb11-34"></a><span class="in">`aggregate`</span> is a Python package that can be used to build approximations to compound (aggregate) probability distributions quickly and accurately, and to solve insurance, risk management, and actuarial problems using realistic models that reflect underlying frequency and severity. It delivers the speed and accuracy of parametric distributions to situations that usually require simulation, making it as easy to work with an aggregate (compound) probability distribution as the lognormal. <span class="in">`aggregate`</span> includes an expressive language called DecL to describe aggregate distributions.</span>
<span id="cb11-35"><a href="#cb11-35"></a></span>
<span id="cb11-36"><a href="#cb11-36"></a>The <span class="in">`aggregate`</span> package is available on <span class="co">[</span><span class="ot">PyPi</span><span class="co">](https://pypi.org/project/aggregate/)</span>, the source code is on GitHub at <span class="ot">&lt;https://github.com/mynl/aggregate&gt;</span>, and there is extensive <span class="co">[</span><span class="ot">documentation</span><span class="co">](https://aggregate.readthedocs.io/en/latest/)</span>. The <span class="in">`Aggregate`</span> class and DecL lanaguage are described in @Mildenhall2024. There is also an extensive series of videos introducing various capabilities available on <span class="co">[</span><span class="ot">YouTube</span><span class="co">](https://www.youtube.com/playlist?list=PLQQxycbewjqMDmw0hfZdB6Rzm60Qcq3Ao)</span>.</span>
<span id="cb11-37"><a href="#cb11-37"></a></span>
<span id="cb11-38"><a href="#cb11-38"></a><span class="fu">## `Aggregate` and R</span></span>
<span id="cb11-39"><a href="#cb11-39"></a></span>
<span id="cb11-40"><a href="#cb11-40"></a>Python packages can be used in R via the reticulate library. Python and R code can also be mixed in RMarkdown (now Quarto) files. This <span class="co">[</span><span class="ot">short video</span><span class="co">](https://www.youtube.com/watch?v=jA9rVMHVqI0)</span> explains how to use <span class="in">`aggregate`</span> from R.</span>
<span id="cb11-41"><a href="#cb11-41"></a></span>
<span id="cb11-42"><a href="#cb11-42"></a><span class="fu">## Reproducing the code examples {#sec-setup-code}</span></span>
<span id="cb11-43"><a href="#cb11-43"></a></span>
<span id="cb11-44"><a href="#cb11-44"></a>To reproduce the Python code examples, you must set up your environment and then install <span class="in">`aggregate`</span> using</span>
<span id="cb11-45"><a href="#cb11-45"></a></span>
<span id="cb11-46"><a href="#cb11-46"></a><span class="in">``` python</span></span>
<span id="cb11-47"><a href="#cb11-47"></a>pip install aggregate</span>
<span id="cb11-48"><a href="#cb11-48"></a><span class="in">```</span></span>
<span id="cb11-49"><a href="#cb11-49"></a></span>
<span id="cb11-50"><a href="#cb11-50"></a>The formatting of the examples relies on <span class="in">`greater_tables`</span>, which can be installed in the same way. The installation process will also install several standard packages, such as <span class="in">`numpy`</span> and <span class="in">`pandas`</span>, that it depends on. If you get an error message about other missing packages, you can install them with <span class="in">`pip`</span>. All the code in the monograph runs on <span class="in">`aggregate`</span> version 0.24.0 and should run on any later version. If you have an older version installed, you can updated it with <span class="in">`pip install -U aggregate`</span>.</span>
<span id="cb11-51"><a href="#cb11-51"></a></span>
<span id="cb11-52"><a href="#cb11-52"></a>Once <span class="in">`aggregate`</span> is installed, start by importing basic libraries. The next code block shows the relevant <span class="in">`aggregate`</span> function. The class <span class="in">`GT`</span> from <span class="in">`greater_tables`</span> is used to format DataFrames consistently.</span>
<span id="cb11-53"><a href="#cb11-53"></a></span>
<span id="cb11-54"><a href="#cb11-54"></a><span class="in">``` python</span></span>
<span id="cb11-55"><a href="#cb11-55"></a><span class="im">from</span> aggregate <span class="im">import</span> (</span>
<span id="cb11-56"><a href="#cb11-56"></a>    Portfolio,                  <span class="co"># creates multi-unit portfolios</span></span>
<span id="cb11-57"><a href="#cb11-57"></a>    make_ceder_netter,          <span class="co"># models reinsurance</span></span>
<span id="cb11-58"><a href="#cb11-58"></a>    Distortion                  <span class="co"># creates a Distortion function</span></span>
<span id="cb11-59"><a href="#cb11-59"></a>)</span>
<span id="cb11-60"><a href="#cb11-60"></a><span class="im">from</span> greater_tables <span class="im">import</span> GT   <span class="co"># consistent table format</span></span>
<span id="cb11-61"><a href="#cb11-61"></a><span class="in">```</span></span>
<span id="cb11-62"><a href="#cb11-62"></a></span>
<span id="cb11-65"><a href="#cb11-65"></a><span class="in">```{python}</span></span>
<span id="cb11-66"><a href="#cb11-66"></a><span class="co">#| echo: false</span></span>
<span id="cb11-67"><a href="#cb11-67"></a><span class="co">#| label: lstx-setup-code</span></span>
<span id="cb11-68"><a href="#cb11-68"></a><span class="op">%</span>run prefob.py</span>
<span id="cb11-69"><a href="#cb11-69"></a></span>
<span id="cb11-70"><a href="#cb11-70"></a><span class="co"># column ordering to match remainder of Monograph</span></span>
<span id="cb11-71"><a href="#cb11-71"></a>jam_order <span class="op">=</span> [<span class="st">'L'</span>, <span class="st">'a'</span>, <span class="st">'Q'</span>, <span class="st">'P'</span>, <span class="st">'M'</span>, <span class="st">'COC'</span>]</span>
<span id="cb11-72"><a href="#cb11-72"></a><span class="in">```</span></span>
<span id="cb11-73"><a href="#cb11-73"></a></span>
<span id="cb11-74"><a href="#cb11-74"></a>\medskip</span>
<span id="cb11-75"><a href="#cb11-75"></a></span>
<span id="cb11-76"><a href="#cb11-76"></a>**Online resources.** Complete code samples can be extracted from the online version of the monograph, available at <span class="ot">&lt;https://cmm.mynl.com/&gt;</span>. Each code block has a small copy icon in the upper right-hand corner. The code blocks on each page can all be shown or hidden using the <span class="in">`&lt;/&gt;Code`</span> control at the top of the page. To download the original qmd file, use the View Source option under the same control. Alternatively, the entire Quarto (previously RMarkdown) source can be downloaded from GitHub at https://github.com/mynl/CapitalModeling (CAS TO INSERT OWN LINK).</span>
<span id="cb11-77"><a href="#cb11-77"></a></span>
<span id="cb11-78"><a href="#cb11-78"></a><span class="fu">## Reproducing the discrete example {#sec-sde}</span></span>
<span id="cb11-79"><a href="#cb11-79"></a></span>
<span id="cb11-80"><a href="#cb11-80"></a><span class="fu">### Input data and setup</span></span>
<span id="cb11-81"><a href="#cb11-81"></a></span>
<span id="cb11-82"><a href="#cb11-82"></a>The InsCo example running through this monograph is based on the 10 events shown in @tbl-10-sims, which reproduces @tbl-dupe-x, and adds the mean and CV. For reference, here is the code to create the underlying dataframe.</span>
<span id="cb11-83"><a href="#cb11-83"></a></span>
<span id="cb11-86"><a href="#cb11-86"></a><span class="in">```{python}</span></span>
<span id="cb11-87"><a href="#cb11-87"></a><span class="co">#| echo: true</span></span>
<span id="cb11-88"><a href="#cb11-88"></a><span class="co">#| label: lstx-loss-sample</span></span>
<span id="cb11-89"><a href="#cb11-89"></a>loss_sample <span class="op">=</span> pd.DataFrame(</span>
<span id="cb11-90"><a href="#cb11-90"></a>    {</span>
<span id="cb11-91"><a href="#cb11-91"></a>        <span class="st">'A'</span>: [ <span class="dv">5</span>,  <span class="dv">7</span>, <span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">13</span>,  <span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">26</span>, <span class="dv">17</span>, <span class="dv">16</span>],</span>
<span id="cb11-92"><a href="#cb11-92"></a>        <span class="st">'B'</span>: [<span class="dv">20</span>, <span class="dv">33</span>, <span class="dv">13</span>,  <span class="dv">7</span>, <span class="dv">20</span>, <span class="dv">27</span>, <span class="dv">16</span>, <span class="dv">19</span>,  <span class="dv">8</span>, <span class="dv">20</span>],</span>
<span id="cb11-93"><a href="#cb11-93"></a>        <span class="st">'C'</span>: [<span class="dv">11</span>,  <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">7</span>,  <span class="dv">8</span>,  <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">40</span>, <span class="dv">64</span>],</span>
<span id="cb11-94"><a href="#cb11-94"></a>    }</span>
<span id="cb11-95"><a href="#cb11-95"></a>)</span>
<span id="cb11-96"><a href="#cb11-96"></a>loss_sample[<span class="st">'total'</span>] <span class="op">=</span> loss_sample.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb11-97"><a href="#cb11-97"></a>loss_sample[<span class="st">'p_total'</span>] <span class="op">=</span> <span class="dv">1</span><span class="op">/</span><span class="dv">10</span></span>
<span id="cb11-98"><a href="#cb11-98"></a><span class="bu">print</span>(loss_sample)</span>
<span id="cb11-99"><a href="#cb11-99"></a><span class="in">```</span></span>
<span id="cb11-100"><a href="#cb11-100"></a></span>
<span id="cb11-103"><a href="#cb11-103"></a><span class="in">```{python}</span></span>
<span id="cb11-104"><a href="#cb11-104"></a><span class="co">#| echo: false</span></span>
<span id="cb11-105"><a href="#cb11-105"></a><span class="co">#| label: tbl-10-sims</span></span>
<span id="cb11-106"><a href="#cb11-106"></a><span class="co">#| tbl-cap: The 10 equally likely simulations underlying the basic examples.</span></span>
<span id="cb11-107"><a href="#cb11-107"></a>loss_sample <span class="op">=</span> pd.DataFrame(</span>
<span id="cb11-108"><a href="#cb11-108"></a>    {</span>
<span id="cb11-109"><a href="#cb11-109"></a>        <span class="st">'A'</span>: [ <span class="dv">5</span>,  <span class="dv">7</span>, <span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">13</span>,  <span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">26</span>, <span class="dv">17</span>, <span class="dv">16</span>],</span>
<span id="cb11-110"><a href="#cb11-110"></a>        <span class="st">'B'</span>: [<span class="dv">20</span>, <span class="dv">33</span>, <span class="dv">13</span>,  <span class="dv">7</span>, <span class="dv">20</span>, <span class="dv">27</span>, <span class="dv">16</span>, <span class="dv">19</span>,  <span class="dv">8</span>, <span class="dv">20</span>],</span>
<span id="cb11-111"><a href="#cb11-111"></a>        <span class="st">'C'</span>: [<span class="dv">11</span>,  <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">7</span>,  <span class="dv">8</span>,  <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">40</span>, <span class="dv">64</span>],</span>
<span id="cb11-112"><a href="#cb11-112"></a>        <span class="st">'p_total'</span>: <span class="dv">1</span><span class="op">/</span><span class="dv">10</span></span>
<span id="cb11-113"><a href="#cb11-113"></a>    }</span>
<span id="cb11-114"><a href="#cb11-114"></a>)</span>
<span id="cb11-115"><a href="#cb11-115"></a>loss_sample[<span class="st">'total'</span>] <span class="op">=</span> loss_sample.iloc[:, :<span class="dv">3</span>].<span class="bu">sum</span>(<span class="dv">1</span>)</span>
<span id="cb11-116"><a href="#cb11-116"></a></span>
<span id="cb11-117"><a href="#cb11-117"></a><span class="co"># add mean and CV</span></span>
<span id="cb11-118"><a href="#cb11-118"></a>wgs <span class="op">=</span> loss_sample.copy()</span>
<span id="cb11-119"><a href="#cb11-119"></a>wgs_ <span class="op">=</span> wgs.copy().drop(columns<span class="op">=</span><span class="st">'p_total'</span>)</span>
<span id="cb11-120"><a href="#cb11-120"></a>wgs_[<span class="st">'total'</span>] <span class="op">=</span> wgs.drop(columns<span class="op">=</span><span class="st">'p_total'</span>).<span class="bu">sum</span>(<span class="dv">1</span>)</span>
<span id="cb11-121"><a href="#cb11-121"></a>wgs2 <span class="op">=</span> wgs_.copy()</span>
<span id="cb11-122"><a href="#cb11-122"></a>wgs2.loc[<span class="st">'EX'</span>, :] <span class="op">=</span> wgs_.mean(<span class="dv">0</span>)</span>
<span id="cb11-123"><a href="#cb11-123"></a>wgs2.loc[<span class="st">'EX2'</span>, :] <span class="op">=</span> (wgs_<span class="op">**</span><span class="dv">2</span>).mean(<span class="dv">0</span>)</span>
<span id="cb11-124"><a href="#cb11-124"></a>wgs2.loc[<span class="st">'Var'</span>, :] <span class="op">=</span> wgs2.loc[<span class="st">'EX2'</span>, :] <span class="op">-</span> wgs2.loc[<span class="st">'EX'</span>, :]<span class="op">**</span><span class="dv">2</span></span>
<span id="cb11-125"><a href="#cb11-125"></a>wgs2.loc[<span class="st">'CV'</span>, :] <span class="op">=</span> wgs2.loc[<span class="st">'Var'</span>, :]<span class="op">**</span><span class="fl">.5</span> <span class="op">/</span> wgs2.loc[<span class="st">'EX'</span>, :]</span>
<span id="cb11-126"><a href="#cb11-126"></a>wgs2 <span class="op">=</span> wgs2.drop(index <span class="op">=</span> [<span class="st">'EX2'</span>, <span class="st">'Var'</span>])</span>
<span id="cb11-127"><a href="#cb11-127"></a>fGT(wgs2)</span>
<span id="cb11-128"><a href="#cb11-128"></a><span class="in">```</span></span>
<span id="cb11-129"><a href="#cb11-129"></a></span>
<span id="cb11-130"><a href="#cb11-130"></a>Now we create an <span class="in">`aggregate`</span> <span class="in">`Portfolio`</span> class instance based on the <span class="in">`loss_sample`</span> simulation output. The next block shows how to do this, using the <span class="in">`Portfolio.create_from_sample`</span> method. <span class="in">`TMA1`</span> is a label, and <span class="in">`loss_sample`</span> is the dataframe created previously. The other arguments specify working with unit-sized buckets <span class="in">`bs=1`</span> appropriate for our integer losses and to use $256=2^8$ buckets, <span class="in">`log2=8`</span>.</span>
<span id="cb11-131"><a href="#cb11-131"></a></span>
<span id="cb11-134"><a href="#cb11-134"></a><span class="in">```{python}</span></span>
<span id="cb11-135"><a href="#cb11-135"></a><span class="co">#| echo: true</span></span>
<span id="cb11-136"><a href="#cb11-136"></a><span class="co">#| label: lstx-create-port</span></span>
<span id="cb11-137"><a href="#cb11-137"></a>wport <span class="op">=</span> Portfolio.create_from_sample(<span class="st">'TMA1'</span>, loss_sample, bs<span class="op">=</span><span class="dv">1</span>, log2<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb11-138"><a href="#cb11-138"></a><span class="in">```</span></span>
<span id="cb11-139"><a href="#cb11-139"></a></span>
<span id="cb11-140"><a href="#cb11-140"></a>The next line of code displays @tbl-wport, which shows summary output from the object <span class="in">`wport`</span> by accessing its <span class="in">`describe`</span> attribute. The summary includes the mean, CV, and skewness. The model and estimated (<span class="in">`Est`</span>) columns are identical because we specified the distribution directly; no simulation or Fast Fourier Transform-based numerical methods are employed.</span>
<span id="cb11-141"><a href="#cb11-141"></a></span>
<span id="cb11-144"><a href="#cb11-144"></a><span class="in">```{python}</span></span>
<span id="cb11-145"><a href="#cb11-145"></a><span class="co">#| echo: true</span></span>
<span id="cb11-146"><a href="#cb11-146"></a><span class="co">#| label: tbl-wport</span></span>
<span id="cb11-147"><a href="#cb11-147"></a><span class="co">#| tbl-cap: Summary statistics for the base example.</span></span>
<span id="cb11-148"><a href="#cb11-148"></a>fGT(wport.describe.drop(columns<span class="op">=</span>[<span class="st">'Err E[X]'</span>, <span class="st">'Err CV(X)'</span>]))</span>
<span id="cb11-149"><a href="#cb11-149"></a><span class="in">```</span></span>
<span id="cb11-150"><a href="#cb11-150"></a></span>
<span id="cb11-151"><a href="#cb11-151"></a>Next, we need to calibrate distortion functions to achieve the desired pricing. The example uses full capitalization throughout (assets equal the maximum loss), which is equivalent to a 100% percentile level (see @tbl-quantiles) and assumes the cost of capital is 15%. The code runs the calibration by calling <span class="in">`wport.calibrate_distortions`</span> with arguments for the capital percentile level <span class="in">`Ps`</span> and cost of capital <span class="in">`COCs`</span>. The arguments are passed as lists because the routine can be used to solve for several percentile levels and costs simultaneously. @tbl-9-1 shows the resulting parameters, which match those in @tbl-the5dists.</span>
<span id="cb11-152"><a href="#cb11-152"></a></span>
<span id="cb11-155"><a href="#cb11-155"></a><span class="in">```{python}</span></span>
<span id="cb11-156"><a href="#cb11-156"></a><span class="co">#| echo: true</span></span>
<span id="cb11-157"><a href="#cb11-157"></a><span class="co">#| label: lstx-9-1</span></span>
<span id="cb11-158"><a href="#cb11-158"></a><span class="co"># calibrate to 15% return at p=100% capital standard</span></span>
<span id="cb11-159"><a href="#cb11-159"></a>wport.calibrate_distortions(Ps<span class="op">=</span>[<span class="dv">1</span>], COCs<span class="op">=</span>[<span class="fl">.15</span>])<span class="op">;</span></span>
<span id="cb11-160"><a href="#cb11-160"></a><span class="in">```</span></span>
<span id="cb11-161"><a href="#cb11-161"></a></span>
<span id="cb11-164"><a href="#cb11-164"></a><span class="in">```{python}</span></span>
<span id="cb11-165"><a href="#cb11-165"></a><span class="co">#| echo: false</span></span>
<span id="cb11-166"><a href="#cb11-166"></a><span class="co">#| label: tbl-9-1</span></span>
<span id="cb11-167"><a href="#cb11-167"></a><span class="co">#| tbl-cap: "Distortion functions calibrated to 15% return on full capital."</span></span>
<span id="cb11-168"><a href="#cb11-168"></a>fGT(wport.distortion_df[[<span class="st">'P'</span>, <span class="st">'param'</span>, <span class="st">'error'</span>]].droplevel([<span class="dv">0</span>, <span class="dv">1</span>], <span class="dv">0</span>))</span>
<span id="cb11-169"><a href="#cb11-169"></a><span class="in">```</span></span>
<span id="cb11-170"><a href="#cb11-170"></a></span>
<span id="cb11-171"><a href="#cb11-171"></a>@fig-distortion-functions shows the resulting distortion $g$ functions (top) and the probability adjustment $Z=q/p$ (bottom). The red star indicates a probability mass at $p=1$.</span>
<span id="cb11-172"><a href="#cb11-172"></a></span>
<span id="cb11-175"><a href="#cb11-175"></a><span class="in">```{python}</span></span>
<span id="cb11-176"><a href="#cb11-176"></a><span class="co">#| echo: false</span></span>
<span id="cb11-177"><a href="#cb11-177"></a><span class="co">#| label: fig-distortion-functions</span></span>
<span id="cb11-178"><a href="#cb11-178"></a><span class="co">#| fig-cap: Distortion functions (top row) and distortion probability adjustment functions (bottom row).</span></span>
<span id="cb11-179"><a href="#cb11-179"></a></span>
<span id="cb11-180"><a href="#cb11-180"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">5</span>, figsize<span class="op">=</span>(<span class="dv">5</span><span class="op">*</span><span class="fl">1.25</span>, <span class="dv">2</span><span class="op">*</span><span class="fl">1.25</span>), constrained_layout<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb11-181"><a href="#cb11-181"></a>                        sharey<span class="op">=</span><span class="va">False</span>, sharex<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb11-182"><a href="#cb11-182"></a>axi0 <span class="op">=</span> <span class="bu">iter</span>(axs[<span class="dv">0</span>])</span>
<span id="cb11-183"><a href="#cb11-183"></a>axi1 <span class="op">=</span> <span class="bu">iter</span>(axs[<span class="dv">1</span>])</span>
<span id="cb11-184"><a href="#cb11-184"></a>xs <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">101</span>)</span>
<span id="cb11-185"><a href="#cb11-185"></a><span class="cf">for</span> (k, v), ax1, ax <span class="kw">in</span> <span class="bu">zip</span>(wport.dists.items(), axi0, axi1):</span>
<span id="cb11-186"><a href="#cb11-186"></a>    <span class="cf">if</span> k <span class="op">==</span> <span class="st">'ccoc'</span>:</span>
<span id="cb11-187"><a href="#cb11-187"></a>        ax.plot([<span class="dv">0</span>,<span class="dv">1</span>], [<span class="dv">1</span><span class="op">/</span><span class="fl">1.15</span>]<span class="op">*</span><span class="dv">2</span>)</span>
<span id="cb11-188"><a href="#cb11-188"></a>        ax.plot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="st">'r*'</span>)</span>
<span id="cb11-189"><a href="#cb11-189"></a>    <span class="cf">else</span>:</span>
<span id="cb11-190"><a href="#cb11-190"></a>        ax.plot(xs, v.g_prime(xs[::<span class="op">-</span><span class="dv">1</span>]))</span>
<span id="cb11-191"><a href="#cb11-191"></a>    ax.plot([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">1</span>,<span class="dv">1</span>], lw<span class="op">=</span><span class="fl">.5</span>, c<span class="op">=</span><span class="st">'k'</span>)</span>
<span id="cb11-192"><a href="#cb11-192"></a>    ax.<span class="bu">set</span>(ylim<span class="op">=</span>[<span class="op">-</span><span class="fl">0.05</span>, <span class="fl">2.5</span>])</span>
<span id="cb11-193"><a href="#cb11-193"></a>    <span class="cf">if</span> ax <span class="kw">is</span> axs[<span class="dv">1</span>][<span class="dv">0</span>]:</span>
<span id="cb11-194"><a href="#cb11-194"></a>        ax.<span class="bu">set</span>(ylabel<span class="op">=</span><span class="st">'Z'</span>, xlabel<span class="op">=</span><span class="st">'Percentile'</span>)</span>
<span id="cb11-195"><a href="#cb11-195"></a></span>
<span id="cb11-196"><a href="#cb11-196"></a>    ax1.plot(xs, v.g(xs))</span>
<span id="cb11-197"><a href="#cb11-197"></a>    ax1.plot([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">0</span>, <span class="dv">1</span>], <span class="st">'k'</span>, lw<span class="op">=</span><span class="fl">.25</span>)</span>
<span id="cb11-198"><a href="#cb11-198"></a>    k <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">(</span><span class="sc">{</span>v<span class="sc">.</span>shape<span class="sc">:.3f}</span><span class="ss">)'</span></span>
<span id="cb11-199"><a href="#cb11-199"></a>    ax1.<span class="bu">set</span>(title<span class="op">=</span>k, ylim<span class="op">=</span>[<span class="op">-</span><span class="fl">0.025</span>, <span class="fl">1.025</span>])</span>
<span id="cb11-200"><a href="#cb11-200"></a>    <span class="cf">if</span> ax1 <span class="kw">is</span> axs[<span class="dv">0</span>][<span class="dv">0</span>]:</span>
<span id="cb11-201"><a href="#cb11-201"></a>        ax1.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Exceedance prob, s'</span>,</span>
<span id="cb11-202"><a href="#cb11-202"></a>                ylabel<span class="op">=</span><span class="st">'g(s)'</span>,</span>
<span id="cb11-203"><a href="#cb11-203"></a>                aspect<span class="op">=</span><span class="st">'equal'</span>)</span>
<span id="cb11-204"><a href="#cb11-204"></a><span class="in">```</span></span>
<span id="cb11-205"><a href="#cb11-205"></a></span>
<span id="cb11-206"><a href="#cb11-206"></a>For technical reasons (discussed in @sec-Complications as well as chapter 14.1.5 in @PIR, see especially Figure 14.2), we must summarize the 10 events by distinct totals. Routine code produces @tbl-5-1, reproducing @tbl-abc-x. <span class="co">&lt;!--# In Table 9.4, the data in the row for index 3 go to the thousandths, while the other rows at most go to tenths. Suggest revising the data in row Index 3 so that it is similar to that of other rows. --&gt;</span></span>
<span id="cb11-207"><a href="#cb11-207"></a></span>
<span id="cb11-210"><a href="#cb11-210"></a><span class="in">```{python}</span></span>
<span id="cb11-211"><a href="#cb11-211"></a><span class="co">#| echo: false</span></span>
<span id="cb11-212"><a href="#cb11-212"></a><span class="co">#| label: tbl-5-1</span></span>
<span id="cb11-213"><a href="#cb11-213"></a><span class="co">#| tbl-cap: Assumptions for portfolio, summarized by distinct totals.</span></span>
<span id="cb11-214"><a href="#cb11-214"></a>bit <span class="op">=</span> loss_sample.copy()</span>
<span id="cb11-215"><a href="#cb11-215"></a>bit[<span class="st">'Total'</span>] <span class="op">=</span> bit[[<span class="st">'A'</span>,<span class="st">'B'</span>,<span class="st">'C'</span>]].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb11-216"><a href="#cb11-216"></a>bit <span class="op">=</span> bit.sort_values(<span class="st">'Total'</span>)</span>
<span id="cb11-217"><a href="#cb11-217"></a>bit2 <span class="op">=</span> bit.groupby(<span class="st">'Total'</span>).<span class="bu">apply</span>(</span>
<span id="cb11-218"><a href="#cb11-218"></a>        <span class="co"># [[]].values -&gt; column vector to broadcast correctly</span></span>
<span id="cb11-219"><a href="#cb11-219"></a>        <span class="kw">lambda</span> grp: (grp[[<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>]] <span class="op">*</span></span>
<span id="cb11-220"><a href="#cb11-220"></a>                    grp[[<span class="st">'p_total'</span>]].values).<span class="bu">sum</span>() <span class="op">/</span> grp[<span class="st">'p_total'</span>].<span class="bu">sum</span>()</span>
<span id="cb11-221"><a href="#cb11-221"></a>        )</span>
<span id="cb11-222"><a href="#cb11-222"></a>bit2[<span class="st">'p'</span>] <span class="op">=</span> bit.groupby(<span class="st">'Total'</span>).<span class="bu">apply</span>(<span class="kw">lambda</span> grp: grp[[<span class="st">'p_total'</span>]].<span class="bu">sum</span>())</span>
<span id="cb11-223"><a href="#cb11-223"></a>bit2 <span class="op">=</span> bit2.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-224"><a href="#cb11-224"></a>bit2.loc[<span class="st">'EX'</span>] <span class="op">=</span> bit.mean(<span class="dv">0</span>)</span>
<span id="cb11-225"><a href="#cb11-225"></a>bit2.loc[<span class="st">'EX'</span>, <span class="st">'p'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb11-226"><a href="#cb11-226"></a>bit2.loc[<span class="st">'Plan'</span>] <span class="op">=</span> [<span class="fl">13.9</span>, <span class="fl">18.7</span>, <span class="fl">19.6</span>, <span class="dv">1</span>]</span>
<span id="cb11-227"><a href="#cb11-227"></a>bit2[<span class="st">'Total'</span>] <span class="op">=</span> bit2[[<span class="st">'A'</span>,<span class="st">'B'</span>,<span class="st">'C'</span>]].<span class="bu">sum</span>(<span class="dv">1</span>)</span>
<span id="cb11-228"><a href="#cb11-228"></a>fGT(bit2)</span>
<span id="cb11-229"><a href="#cb11-229"></a><span class="in">```</span></span>
<span id="cb11-230"><a href="#cb11-230"></a></span>
<span id="cb11-231"><a href="#cb11-231"></a>The examples describe a VaR- or TVaR-based capital standard (see @tbl-CA-loss-levels), but for this example it works out to the the same as a fully capitalized 100% standard, as shown by the values in @tbl-quantiles. The <span class="in">`wport`</span> methods <span class="in">`q`</span> and <span class="in">`tvar`</span> compute quantiles and TVaRs for each unit and the total.</span>
<span id="cb11-232"><a href="#cb11-232"></a></span>
<span id="cb11-235"><a href="#cb11-235"></a><span class="in">```{python}</span></span>
<span id="cb11-236"><a href="#cb11-236"></a><span class="co">#| echo: false</span></span>
<span id="cb11-237"><a href="#cb11-237"></a><span class="co">#| label: tbl-quantiles</span></span>
<span id="cb11-238"><a href="#cb11-238"></a><span class="co">#| tbl-cap: Quantiles (VaR) and TVaR at different probability levels.</span></span>
<span id="cb11-239"><a href="#cb11-239"></a>ps <span class="op">=</span> [<span class="fl">.8</span>, <span class="fl">.85</span>, <span class="fl">.9</span>, <span class="dv">1</span>]</span>
<span id="cb11-240"><a href="#cb11-240"></a>fGT(pd.DataFrame({<span class="st">'p'</span>: ps, <span class="st">'Quantile'</span>: wport.q(ps),</span>
<span id="cb11-241"><a href="#cb11-241"></a>                 <span class="st">'TVaR'</span>: wport.tvar(ps)}).set_index(<span class="st">'p'</span>))</span>
<span id="cb11-242"><a href="#cb11-242"></a><span class="in">```</span></span>
<span id="cb11-243"><a href="#cb11-243"></a></span>
<span id="cb11-244"><a href="#cb11-244"></a><span class="fu">### Premiums by distortion</span></span>
<span id="cb11-245"><a href="#cb11-245"></a></span>
<span id="cb11-246"><a href="#cb11-246"></a>@tbl-isa-alloc shows premium assuming a CCoC distortion with a 15% return applied using a 100% capital standard. The premium <span class="in">`P`</span> row shows what @PIR calls the linear NA premium. @tbl-ccoc-na reproduces this exhibit, confirming an equal 15% returns across all allocated capital. The code illustrates the power of <span class="in">`aggregate`</span>. The first line creates a CCoC distortion using the <span class="in">`Distortion`</span> class; note the argument is risk discount $\delta$. The second line uses the <span class="in">`price`</span> method to compute the linear allocation, which it returns in a structure with various diagnostic information, including @tbl-ccoc-na. <span class="co">&lt;!--# In Table 9.6, I would capitalize "Total," so it matches the style of other tables. --&gt;</span></span>
<span id="cb11-247"><a href="#cb11-247"></a></span>
<span id="cb11-250"><a href="#cb11-250"></a><span class="in">```{python}</span></span>
<span id="cb11-251"><a href="#cb11-251"></a><span class="co">#| echo: true</span></span>
<span id="cb11-252"><a href="#cb11-252"></a><span class="co">#| label: lstx-ccoc-na-0</span></span>
<span id="cb11-253"><a href="#cb11-253"></a>ccoc <span class="op">=</span> Distortion.ccoc(<span class="fl">.15</span> <span class="op">/</span> <span class="fl">1.15</span>)</span>
<span id="cb11-254"><a href="#cb11-254"></a>pricing_info <span class="op">=</span> wport.price(<span class="dv">1</span>, ccoc, allocation<span class="op">=</span><span class="st">'linear'</span>)</span>
<span id="cb11-255"><a href="#cb11-255"></a><span class="in">```</span></span>
<span id="cb11-256"><a href="#cb11-256"></a></span>
<span id="cb11-259"><a href="#cb11-259"></a><span class="in">```{python}</span></span>
<span id="cb11-260"><a href="#cb11-260"></a><span class="co">#| echo: false</span></span>
<span id="cb11-261"><a href="#cb11-261"></a><span class="co">#| label: tbl-ccoc-na</span></span>
<span id="cb11-262"><a href="#cb11-262"></a><span class="co">#| tbl-cap: Industry standard approach pricing using the CCoC distortion.</span></span>
<span id="cb11-263"><a href="#cb11-263"></a><span class="co"># best to drop the multi-index columns</span></span>
<span id="cb11-264"><a href="#cb11-264"></a>fGT(pricing_info.df[jam_order].T.droplevel(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb11-265"><a href="#cb11-265"></a>    aligners<span class="op">=</span>{c: <span class="st">'r'</span> <span class="cf">for</span> c <span class="kw">in</span> jam_order})</span>
<span id="cb11-266"><a href="#cb11-266"></a><span class="in">```</span></span>
<span id="cb11-267"><a href="#cb11-267"></a></span>
<span id="cb11-268"><a href="#cb11-268"></a>@tbl-x-collapsed, @tbl-ccoc-1 and @tbl-ccoc-qx compute $\rho(X)$ for $\rho$ the CCoC SRM, using the $\rho(X)=\int g(S(x))\,dx$ (second table) and $\rho(X)=\int xg'(S(x))f(x)\,dx$ (third) representations. The numbers needed for these calculations are shown in @tbl-gs-calcs, where $q=g'(S(x))f(x)$. These are extracted from the dataframe <span class="in">`wport.density_df,`</span> which contains the probability mass, density, and survival functions for the portfolio, among other facts. The last row carries out the calculations and confirms the two methods give the same result, the total under $gS$ using the former representation and under $q$ using the latter representation.</span>
<span id="cb11-269"><a href="#cb11-269"></a></span>
<span id="cb11-272"><a href="#cb11-272"></a><span class="in">```{python}</span></span>
<span id="cb11-273"><a href="#cb11-273"></a><span class="co">#| echo: false</span></span>
<span id="cb11-274"><a href="#cb11-274"></a><span class="co">#| label: tbl-gs-calcs</span></span>
<span id="cb11-275"><a href="#cb11-275"></a><span class="co">#| tbl-cap: "Industry standard approach pricing: raw ingredients and computed means."</span></span>
<span id="cb11-276"><a href="#cb11-276"></a>bit <span class="op">=</span> wport.density_df.query(<span class="st">'p_total &gt; 0'</span>)[[<span class="st">'p_total'</span>, <span class="st">'F'</span>, <span class="st">'S'</span>]]</span>
<span id="cb11-277"><a href="#cb11-277"></a>bit[<span class="st">'gS'</span>] <span class="op">=</span> ccoc.g(bit.S)</span>
<span id="cb11-278"><a href="#cb11-278"></a>bit[<span class="st">'q'</span>] <span class="op">=</span> <span class="op">-</span>np.diff(bit.gS, prepend<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb11-279"><a href="#cb11-279"></a>bit[<span class="st">'ΔX'</span>] <span class="op">=</span> np.diff(bit.index, append<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb11-280"><a href="#cb11-280"></a>bit.index.name <span class="op">=</span> <span class="st">'loss'</span></span>
<span id="cb11-281"><a href="#cb11-281"></a>eq <span class="op">=</span> (bit.index <span class="op">*</span> bit.q).<span class="bu">sum</span>()</span>
<span id="cb11-282"><a href="#cb11-282"></a>gsdx <span class="op">=</span> (bit.gS.iloc[:<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> np.diff(bit.index)).<span class="bu">sum</span>() <span class="op">+</span> bit.index[<span class="dv">0</span>]</span>
<span id="cb11-283"><a href="#cb11-283"></a>bit.loc[<span class="st">'$</span><span class="ch">\\</span><span class="st">rho(X)$'</span>] <span class="op">=</span> <span class="st">''</span></span>
<span id="cb11-284"><a href="#cb11-284"></a>bit.loc[<span class="st">'$</span><span class="ch">\\</span><span class="st">rho(X)$'</span>, <span class="st">'q'</span>] <span class="op">=</span> eq</span>
<span id="cb11-285"><a href="#cb11-285"></a>bit.loc[<span class="st">'$</span><span class="ch">\\</span><span class="st">rho(X)$'</span>, <span class="st">'gS'</span>] <span class="op">=</span> gsdx</span>
<span id="cb11-286"><a href="#cb11-286"></a></span>
<span id="cb11-287"><a href="#cb11-287"></a>fGT(bit, aligners<span class="op">=</span>{c:<span class="st">'r'</span> <span class="cf">for</span> c <span class="kw">in</span> bit.columns})</span>
<span id="cb11-288"><a href="#cb11-288"></a><span class="in">```</span></span>
<span id="cb11-289"><a href="#cb11-289"></a></span>
<span id="cb11-290"><a href="#cb11-290"></a><span class="co">&lt;!-- @tbl-Wang-alloc shows the results of using the Wang distortion in place of the CCoC.  --&gt;</span></span>
<span id="cb11-291"><a href="#cb11-291"></a></span>
<span id="cb11-292"><a href="#cb11-292"></a>@tbl-all-distortion-pricing shows the results for the other standard distortions. The calculations match those of the Wang in @tbl-all-distortion-pricing-3. All of the calibrated distortions are carried in the dictionary <span class="in">`wport.dists`</span>. These tables also include the NA of capital (a process we do not recommend, but that is described in @sec-Allocating-Capital). The <span class="in">`Q`</span> row matches the calculation of allocated capital shown in @tbl-q-alloc. <span class="co">&lt;!--# In Table 9.8, I also recommend capitalizing "Total" in the fourth column all all panels for consistency. --&gt;</span></span>
<span id="cb11-293"><a href="#cb11-293"></a></span>
<span id="cb11-296"><a href="#cb11-296"></a><span class="in">```{python}</span></span>
<span id="cb11-297"><a href="#cb11-297"></a><span class="co">#| echo: false</span></span>
<span id="cb11-298"><a href="#cb11-298"></a><span class="co">#| label: tbl-all-distortion-pricing</span></span>
<span id="cb11-299"><a href="#cb11-299"></a><span class="co">#| tbl-cap: Pricing by distortion by unit.</span></span>
<span id="cb11-300"><a href="#cb11-300"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb11-301"><a href="#cb11-301"></a><span class="co">#| tbl-subcap: [CCoC, PH, Wang, Dual, TVaR]</span></span>
<span id="cb11-302"><a href="#cb11-302"></a></span>
<span id="cb11-303"><a href="#cb11-303"></a><span class="cf">for</span> k, g <span class="kw">in</span> wport.dists.items():</span>
<span id="cb11-304"><a href="#cb11-304"></a>    display(fGT(</span>
<span id="cb11-305"><a href="#cb11-305"></a>        wport.price(<span class="dv">1</span>, g, allocation<span class="op">=</span><span class="st">'lifted'</span>).df[jam_order].T.droplevel(<span class="dv">0</span>, <span class="dv">1</span>)))</span>
<span id="cb11-306"><a href="#cb11-306"></a><span class="in">```</span></span>
<span id="cb11-307"><a href="#cb11-307"></a></span>
<span id="cb11-308"><a href="#cb11-308"></a><span class="fu">### Reinsurance analysis</span></span>
<span id="cb11-309"><a href="#cb11-309"></a></span>
<span id="cb11-310"><a href="#cb11-310"></a>@sec-Applications analyzes a possible 35 xs 65 aggregate stop loss reinsurance contract. The setup to analyze this contract, using a separate <span class="in">`Portfolio`</span> object, is shown next. The first two lines apply reinsurance; <span class="in">`[1, 35, 65]`</span> specifies 100% of the 35 xs 65 layer, and <span class="in">`c`</span> and <span class="in">`n`</span> are functions mapping gross to ceded and net. The last line creates a new <span class="in">`Portfolio`</span> object from the net and ceded aggregate losses.</span>
<span id="cb11-311"><a href="#cb11-311"></a></span>
<span id="cb11-314"><a href="#cb11-314"></a><span class="in">```{python}</span></span>
<span id="cb11-315"><a href="#cb11-315"></a><span class="co">#| echo: true</span></span>
<span id="cb11-316"><a href="#cb11-316"></a><span class="co">#| label: lstx-setup-re</span></span>
<span id="cb11-317"><a href="#cb11-317"></a>loss_sample_re <span class="op">=</span> loss_sample.copy()</span>
<span id="cb11-318"><a href="#cb11-318"></a>c, n <span class="op">=</span> make_ceder_netter([(<span class="dv">1</span>, <span class="dv">35</span>, <span class="dv">65</span>)])</span>
<span id="cb11-319"><a href="#cb11-319"></a>loss_sample_re[<span class="st">'Net'</span>] <span class="op">=</span> n(loss_sample_re.total)</span>
<span id="cb11-320"><a href="#cb11-320"></a>loss_sample_re[<span class="st">'Ceded'</span>] <span class="op">=</span> c(loss_sample_re.total)</span>
<span id="cb11-321"><a href="#cb11-321"></a>loss_sample_re <span class="op">=</span> loss_sample_re[[<span class="st">'Net'</span>, <span class="st">'Ceded'</span>, <span class="st">'p_total'</span>]]</span>
<span id="cb11-322"><a href="#cb11-322"></a></span>
<span id="cb11-323"><a href="#cb11-323"></a><span class="co"># build Portfolio object with Net, Ceded units</span></span>
<span id="cb11-324"><a href="#cb11-324"></a>wport_re <span class="op">=</span> Portfolio.create_from_sample(<span class="st">'WGS3'</span>,</span>
<span id="cb11-325"><a href="#cb11-325"></a>            loss_sample_re[[<span class="st">'Net'</span>, <span class="st">'Ceded'</span>, <span class="st">'p_total'</span>]], bs<span class="op">=</span><span class="dv">1</span>, log2<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb11-326"><a href="#cb11-326"></a><span class="in">```</span></span>
<span id="cb11-327"><a href="#cb11-327"></a></span>
<span id="cb11-328"><a href="#cb11-328"></a>@tbl-re-object shows the standard summary statistics. <span class="co">&lt;!--# In Table 9.9, for consistency, I would capitalize "total" in column 1. --&gt;</span> It should be compared to @tbl-events-with-RI. @tbl-all-distortioun-re-pricing shows the allocated pricing to the reinsurance and net across the five standard distortions, compare with the last row of @tbl-events-with-RI and discussion in @sec-Reinsurance-decision-making. <span class="co">&lt;!--# In Table 9.10, recommend capitalizing "total" in the far right column of the header row. --&gt;</span></span>
<span id="cb11-329"><a href="#cb11-329"></a></span>
<span id="cb11-332"><a href="#cb11-332"></a><span class="in">```{python}</span></span>
<span id="cb11-333"><a href="#cb11-333"></a><span class="co">#| echo: false</span></span>
<span id="cb11-334"><a href="#cb11-334"></a><span class="co">#| label: tbl-re-object</span></span>
<span id="cb11-335"><a href="#cb11-335"></a><span class="co">#| tbl-cap: "Summary statistics created by the reinsurance Portfolio object."</span></span>
<span id="cb11-336"><a href="#cb11-336"></a>fGT(wport_re.describe.drop(columns<span class="op">=</span>[<span class="st">'Err E[X]'</span>, <span class="st">'Err CV(X)'</span>]))</span>
<span id="cb11-337"><a href="#cb11-337"></a><span class="in">```</span></span>
<span id="cb11-338"><a href="#cb11-338"></a></span>
<span id="cb11-341"><a href="#cb11-341"></a><span class="in">```{python}</span></span>
<span id="cb11-342"><a href="#cb11-342"></a><span class="co">#| echo: false</span></span>
<span id="cb11-343"><a href="#cb11-343"></a><span class="co">#| label: tbl-all-distortioun-re-pricing</span></span>
<span id="cb11-344"><a href="#cb11-344"></a><span class="co">#| tbl-cap: Pricing by distortion for ceded, net, and total (gross).</span></span>
<span id="cb11-345"><a href="#cb11-345"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb11-346"><a href="#cb11-346"></a><span class="co">#| tbl-subcap: [CCoC, PH, Wang, Dual, TVaR]</span></span>
<span id="cb11-347"><a href="#cb11-347"></a></span>
<span id="cb11-348"><a href="#cb11-348"></a><span class="cf">for</span> k, g <span class="kw">in</span> wport.dists.items():</span>
<span id="cb11-349"><a href="#cb11-349"></a>    display(fGT(wport_re.price(<span class="dv">1</span>, g, allocation<span class="op">=</span><span class="st">'lifted'</span>).df[jam_order].T.droplevel(<span class="dv">0</span>, <span class="dv">1</span>)))</span>
<span id="cb11-350"><a href="#cb11-350"></a><span class="in">```</span></span>
<span id="cb11-351"><a href="#cb11-351"></a></span>
<span id="cb11-352"><a href="#cb11-352"></a>\clearpage</span>
<span id="cb11-353"><a href="#cb11-353"></a></span>
<span id="cb11-354"><a href="#cb11-354"></a><span class="fu">## A more realistic example {#sec-realistic}</span></span>
<span id="cb11-355"><a href="#cb11-355"></a></span>
<span id="cb11-356"><a href="#cb11-356"></a>In this section, we create a series of exhibits analogous to those in @sec-sde for an example with more realistic assumptions. It is included to show how <span class="in">`aggregate`</span> can be used to solve real-world problems, hopefully motivating you to explore it further. The analysis steps are:</span>
<span id="cb11-357"><a href="#cb11-357"></a></span>
<span id="cb11-358"><a href="#cb11-358"></a><span class="ss">1.  </span>Create realistic by-unit frequency and severity distributions using Fast Fourier Transforms with independent units.</span>
<span id="cb11-359"><a href="#cb11-359"></a><span class="ss">2.  </span>Sample the unit distributions with correlation induced by Iman-Conover, @sec-iman-conover.</span>
<span id="cb11-360"><a href="#cb11-360"></a><span class="ss">3.  </span>Build a <span class="in">`Portfolio`</span> from the correlated sample.</span>
<span id="cb11-361"><a href="#cb11-361"></a><span class="ss">4.  </span>Calibrate distortions and compute unit pricing for each distortion.</span>
<span id="cb11-362"><a href="#cb11-362"></a><span class="ss">5.  </span>Apply by-unit, per-occurrence reinsurance and examine pricing impact.</span>
<span id="cb11-363"><a href="#cb11-363"></a></span>
<span id="cb11-364"><a href="#cb11-364"></a>The <span class="in">`aggregate`</span> DecL programming language makes it easy to specify frequency-severity compound distributions. In the code chunk below, the four lines inside the <span class="in">`build`</span> statement are the DecL program. The triple quotes are Python shorthand for entering a multiline string. The first program line, beginning <span class="in">`agg Auto`</span>, creates a distribution with an expected loss of 5000 (think: losses in 000s), severity from the 5000 xs 0 layer of a lognormal variable with a mean of 50 and a CV of 2, and gamma mixed-Poisson frequency with a mixing parameter (CV) of 0.2. The other two lines are analogous. The <span class="in">`build`</span> statement runs the DecL program and creates a <span class="in">`Portfolio`</span> object with relevant compound distributions by unit. It also sums the unit distributions as though they were independent---we will introduce some correlation later.</span>
<span id="cb11-365"><a href="#cb11-365"></a></span>
<span id="cb11-368"><a href="#cb11-368"></a><span class="in">```{python}</span></span>
<span id="cb11-369"><a href="#cb11-369"></a><span class="co">#| echo: true</span></span>
<span id="cb11-370"><a href="#cb11-370"></a><span class="co">#| label: lstx-univariates-0</span></span>
<span id="cb11-371"><a href="#cb11-371"></a><span class="im">from</span> aggregate <span class="im">import</span> build</span>
<span id="cb11-372"><a href="#cb11-372"></a>port <span class="op">=</span> build(<span class="st">"""</span></span>
<span id="cb11-373"><a href="#cb11-373"></a><span class="st">port Units</span></span>
<span id="cb11-374"><a href="#cb11-374"></a><span class="st">    agg Auto 5000 loss  5000 xs 0 sev lognorm 50 cv  2 mixed gamma 0.2</span></span>
<span id="cb11-375"><a href="#cb11-375"></a><span class="st">    agg GL   3000 loss  2500 xs 0 sev lognorm 75 cv  3 mixed gamma 0.3</span></span>
<span id="cb11-376"><a href="#cb11-376"></a><span class="st">    agg WC   7000 loss 25000 xs 0 sev lognorm  5 cv 10 mixed gamma 0.25</span></span>
<span id="cb11-377"><a href="#cb11-377"></a><span class="st">"""</span>)</span>
<span id="cb11-378"><a href="#cb11-378"></a><span class="in">```</span></span>
<span id="cb11-379"><a href="#cb11-379"></a></span>
<span id="cb11-380"><a href="#cb11-380"></a>@tbl-univariates-1 shows the by-unit frequency and severity statistics and the total statistics assuming the units are independent. The deviation between the Fast Fourier Transform-generated compound distributions and the requested specifications are negligible. @fig-univariates plots the unit and total densities on a nominal and log scale. The effect of WC driving the tail, via thicker severity and higher occurrence limit, is clear on the log plot. <span class="co">&lt;!--# In Table 9.11, recommend capitalizing "Total." --&gt;</span></span>
<span id="cb11-381"><a href="#cb11-381"></a></span>
<span id="cb11-384"><a href="#cb11-384"></a><span class="in">```{python}</span></span>
<span id="cb11-385"><a href="#cb11-385"></a><span class="co">#| echo: false</span></span>
<span id="cb11-386"><a href="#cb11-386"></a><span class="co">#| label: tbl-univariates-1</span></span>
<span id="cb11-387"><a href="#cb11-387"></a><span class="co">#| tbl-cap: "Unit frequency, severity and compound assumptions, and portfolio total, showing requested and model achieved and key statistics."</span></span>
<span id="cb11-388"><a href="#cb11-388"></a>fGT(port.describe.drop(columns<span class="op">=</span>[<span class="st">'Err E[X]'</span>, <span class="st">'Err CV(X)'</span>]).fillna(<span class="dv">0</span>))</span>
<span id="cb11-389"><a href="#cb11-389"></a><span class="in">```</span></span>
<span id="cb11-390"><a href="#cb11-390"></a></span>
<span id="cb11-393"><a href="#cb11-393"></a><span class="in">```{python}</span></span>
<span id="cb11-394"><a href="#cb11-394"></a><span class="co">#| echo: false</span></span>
<span id="cb11-395"><a href="#cb11-395"></a><span class="co">#| label: fig-univariates</span></span>
<span id="cb11-396"><a href="#cb11-396"></a><span class="co">#| fig-cap: By-unit loss densities (left) and logdensities (right).</span></span>
<span id="cb11-397"><a href="#cb11-397"></a></span>
<span id="cb11-398"><a href="#cb11-398"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="fl">2.5</span>), constrained_layout<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-399"><a href="#cb11-399"></a>ax0, ax1 <span class="op">=</span> axs.flat</span>
<span id="cb11-400"><a href="#cb11-400"></a></span>
<span id="cb11-401"><a href="#cb11-401"></a>bit <span class="op">=</span> port.density_df[[<span class="ss">f'p_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> port.unit_names_ex]]</span>
<span id="cb11-402"><a href="#cb11-402"></a>bit.plot(ax<span class="op">=</span>ax0)</span>
<span id="cb11-403"><a href="#cb11-403"></a>ax0.<span class="bu">set</span>(title<span class="op">=</span><span class="st">'Loss density by unit'</span>, xlim<span class="op">=</span>[<span class="dv">0</span>, port.q(<span class="fl">0.999</span>)], xlabel<span class="op">=</span><span class="st">'Loss'</span>,</span>
<span id="cb11-404"><a href="#cb11-404"></a>       ylabel<span class="op">=</span><span class="st">'Density'</span>)</span>
<span id="cb11-405"><a href="#cb11-405"></a></span>
<span id="cb11-406"><a href="#cb11-406"></a></span>
<span id="cb11-407"><a href="#cb11-407"></a>bit <span class="op">=</span> port.density_df[[<span class="ss">f'p_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> port.unit_names_ex]]</span>
<span id="cb11-408"><a href="#cb11-408"></a>bit.plot(ax<span class="op">=</span>ax1)</span>
<span id="cb11-409"><a href="#cb11-409"></a>ax1.legend().<span class="bu">set</span>(visible<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb11-410"><a href="#cb11-410"></a>ax1.<span class="bu">set</span>(title<span class="op">=</span><span class="st">'Loss log-density by unit'</span>,</span>
<span id="cb11-411"><a href="#cb11-411"></a>        xlim<span class="op">=</span>[<span class="dv">0</span>, port.q(<span class="fl">0.999999</span>)], xlabel<span class="op">=</span><span class="st">'Loss'</span>,</span>
<span id="cb11-412"><a href="#cb11-412"></a>        yscale<span class="op">=</span><span class="st">'log'</span>, ylabel<span class="op">=</span><span class="st">'Log density'</span>,</span>
<span id="cb11-413"><a href="#cb11-413"></a>        ylim<span class="op">=</span>[<span class="fl">1e-15</span>, <span class="fl">1e-3</span>])<span class="op">;</span></span>
<span id="cb11-414"><a href="#cb11-414"></a><span class="in">```</span></span>
<span id="cb11-415"><a href="#cb11-415"></a></span>
<span id="cb11-416"><a href="#cb11-416"></a>Next, we sample from the unit distributions and shuffle using Iman-Conover to achieve the desired correlation shown in @tbl-correl. This matrix comes from a separate analysis. The revised statistics (note higher total CV), quantiles, and achieved correlation are shown in @tbl-stats-sample and @tbl-correl-sample. <span class="co">&lt;!--# In Table 9.14, recommend capitalizing "Total." --&gt;</span></span>
<span id="cb11-417"><a href="#cb11-417"></a></span>
<span id="cb11-420"><a href="#cb11-420"></a><span class="in">```{python}</span></span>
<span id="cb11-421"><a href="#cb11-421"></a><span class="co">#| echo: false</span></span>
<span id="cb11-422"><a href="#cb11-422"></a><span class="co">#| label: tbl-correl</span></span>
<span id="cb11-423"><a href="#cb11-423"></a><span class="co">#| tbl-cap: "Desired correlation matrix, as input to Iman-Conover."</span></span>
<span id="cb11-424"><a href="#cb11-424"></a>desired_corr <span class="op">=</span> np.array([[<span class="fl">1.</span>,    <span class="fl">.5</span>,   <span class="fl">.4</span>],</span>
<span id="cb11-425"><a href="#cb11-425"></a>                        [<span class="fl">.5</span>,    <span class="fl">1.</span>,   <span class="fl">.1</span>],</span>
<span id="cb11-426"><a href="#cb11-426"></a>                        [<span class="fl">.4</span>,    <span class="fl">.1</span>,   <span class="fl">1.</span>]])</span>
<span id="cb11-427"><a href="#cb11-427"></a>fGT(pd.DataFrame(desired_corr, index<span class="op">=</span>port.unit_names, columns<span class="op">=</span>port.unit_names))</span>
<span id="cb11-428"><a href="#cb11-428"></a><span class="in">```</span></span>
<span id="cb11-429"><a href="#cb11-429"></a></span>
<span id="cb11-432"><a href="#cb11-432"></a><span class="in">```{python}</span></span>
<span id="cb11-433"><a href="#cb11-433"></a><span class="co">#| echo: false</span></span>
<span id="cb11-434"><a href="#cb11-434"></a><span class="co">#| label: tbl-stats-sample</span></span>
<span id="cb11-435"><a href="#cb11-435"></a><span class="co">#| tbl-cap: 'Key statistics from sample with Iman-Conover induced correlation.'</span></span>
<span id="cb11-436"><a href="#cb11-436"></a>sample <span class="op">=</span> port.sample(<span class="dv">1000</span>, desired_correlation<span class="op">=</span>desired_corr)</span>
<span id="cb11-437"><a href="#cb11-437"></a>sample[<span class="st">'total'</span>] <span class="op">=</span> sample.<span class="bu">sum</span>(<span class="dv">1</span>)</span>
<span id="cb11-438"><a href="#cb11-438"></a>st <span class="op">=</span> sample.describe()</span>
<span id="cb11-439"><a href="#cb11-439"></a>st.loc[<span class="st">'CV'</span>] <span class="op">=</span> st.loc[<span class="st">'std'</span>] <span class="op">/</span> st.loc[<span class="st">'mean'</span>]</span>
<span id="cb11-440"><a href="#cb11-440"></a>display(fGT(st))</span>
<span id="cb11-441"><a href="#cb11-441"></a><span class="in">```</span></span>
<span id="cb11-442"><a href="#cb11-442"></a></span>
<span id="cb11-445"><a href="#cb11-445"></a><span class="in">```{python}</span></span>
<span id="cb11-446"><a href="#cb11-446"></a><span class="co">#| echo: false</span></span>
<span id="cb11-447"><a href="#cb11-447"></a><span class="co">#| label: tbl-correl-sample</span></span>
<span id="cb11-448"><a href="#cb11-448"></a><span class="co">#| tbl-cap: 'Achived between-unit correlation.'</span></span>
<span id="cb11-449"><a href="#cb11-449"></a></span>
<span id="cb11-450"><a href="#cb11-450"></a>lin <span class="op">=</span> sample.corr()</span>
<span id="cb11-451"><a href="#cb11-451"></a>rk <span class="op">=</span> sample.corr(<span class="st">'spearman'</span>)</span>
<span id="cb11-452"><a href="#cb11-452"></a>mask <span class="op">=</span> np.tril(np.ones(rk.shape), k<span class="op">=-</span><span class="dv">1</span>)<span class="op">==</span><span class="dv">1</span></span>
<span id="cb11-453"><a href="#cb11-453"></a>fGT(lin.where(<span class="op">~</span>mask, other<span class="op">=</span><span class="dv">0</span>) <span class="op">+</span> rk.where(mask, other<span class="op">=</span><span class="dv">0</span>))</span>
<span id="cb11-454"><a href="#cb11-454"></a><span class="in">```</span></span>
<span id="cb11-455"><a href="#cb11-455"></a></span>
<span id="cb11-456"><a href="#cb11-456"></a>@tbl-univariates-corr shows the output of using the correlated sample to build a <span class="in">`Portfolio`</span> object. <span class="co">&lt;!--# In Table 9.15, recommend capitalizing "Total."  --&gt;</span>This uses the samples directly, proxying the aggregate loss as a compound with degenerate frequency distribution identically equal to one and severity equal to the desired distribution. Hence the frequency rows show expectation one with zero CV.</span>
<span id="cb11-457"><a href="#cb11-457"></a></span>
<span id="cb11-460"><a href="#cb11-460"></a><span class="in">```{python}</span></span>
<span id="cb11-461"><a href="#cb11-461"></a><span class="co">#| echo: false</span></span>
<span id="cb11-462"><a href="#cb11-462"></a><span class="co">#| label: tbl-univariates-corr</span></span>
<span id="cb11-463"><a href="#cb11-463"></a><span class="co">#| tbl-cap: "Portfolio statistics reflecting the correlation achieved by the Iman-Conover sample."</span></span>
<span id="cb11-464"><a href="#cb11-464"></a>port_corr <span class="op">=</span> Portfolio.create_from_sample(<span class="st">'UnitsCorr'</span>, sample,</span>
<span id="cb11-465"><a href="#cb11-465"></a>            bs<span class="op">=</span>port.bs, log2<span class="op">=</span>port.log2)</span>
<span id="cb11-466"><a href="#cb11-466"></a>fGT(port_corr.describe.drop(columns<span class="op">=</span>[<span class="st">'Err E[X]'</span>, <span class="st">'Err CV(X)'</span>]))</span>
<span id="cb11-467"><a href="#cb11-467"></a><span class="in">```</span></span>
<span id="cb11-468"><a href="#cb11-468"></a></span>
<span id="cb11-469"><a href="#cb11-469"></a>@tbl-param-d shows the parameters for distortions calibrated to achieve an overall 15% return at a 99.5% capital standard. @fig-distortion-functions-sample plots the distortions and probability adjustment functions, compare this with @fig-distortion-functions. These distortions are slightly more risk averse (higher parameters except PH, driving higher indicated prices).</span>
<span id="cb11-470"><a href="#cb11-470"></a></span>
<span id="cb11-473"><a href="#cb11-473"></a><span class="in">```{python}</span></span>
<span id="cb11-474"><a href="#cb11-474"></a><span class="co">#| echo: false</span></span>
<span id="cb11-475"><a href="#cb11-475"></a><span class="co">#| label: tbl-param-d</span></span>
<span id="cb11-476"><a href="#cb11-476"></a><span class="co">#| tbl-cap: "Distortion parameters for to target total return at the regulatory capital standard."</span></span>
<span id="cb11-477"><a href="#cb11-477"></a>reg_p <span class="op">=</span> <span class="fl">0.995</span>  <span class="co"># regulatory capital standard</span></span>
<span id="cb11-478"><a href="#cb11-478"></a>wacc <span class="op">=</span> <span class="fl">0.15</span>    <span class="co"># computed total weighted average cost of capital</span></span>
<span id="cb11-479"><a href="#cb11-479"></a>port_corr.calibrate_distortions(Ps<span class="op">=</span>[reg_p], COCs<span class="op">=</span>[wacc])</span>
<span id="cb11-480"><a href="#cb11-480"></a>fGT(port_corr.distortion_df[[<span class="st">'P'</span>, <span class="st">'param'</span>, <span class="st">'error'</span>]].droplevel([<span class="dv">0</span>, <span class="dv">1</span>], <span class="dv">0</span>))</span>
<span id="cb11-481"><a href="#cb11-481"></a><span class="in">```</span></span>
<span id="cb11-482"><a href="#cb11-482"></a></span>
<span id="cb11-485"><a href="#cb11-485"></a><span class="in">```{python}</span></span>
<span id="cb11-486"><a href="#cb11-486"></a><span class="co">#| echo: false</span></span>
<span id="cb11-487"><a href="#cb11-487"></a><span class="co">#| label: fig-distortion-functions-sample</span></span>
<span id="cb11-488"><a href="#cb11-488"></a><span class="co">#| fig-cap: Distortion functions and distortion probability adjustment functions.</span></span>
<span id="cb11-489"><a href="#cb11-489"></a></span>
<span id="cb11-490"><a href="#cb11-490"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">5</span>, figsize<span class="op">=</span>(<span class="dv">5</span><span class="op">*</span><span class="fl">1.25</span>, <span class="dv">2</span><span class="op">*</span><span class="fl">1.25</span>),</span>
<span id="cb11-491"><a href="#cb11-491"></a>                        constrained_layout<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb11-492"><a href="#cb11-492"></a>                        sharey<span class="op">=</span><span class="va">False</span>, sharex<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb11-493"><a href="#cb11-493"></a>axi0 <span class="op">=</span> <span class="bu">iter</span>(axs[<span class="dv">0</span>])</span>
<span id="cb11-494"><a href="#cb11-494"></a>axi1 <span class="op">=</span> <span class="bu">iter</span>(axs[<span class="dv">1</span>])</span>
<span id="cb11-495"><a href="#cb11-495"></a>xs <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">101</span>)</span>
<span id="cb11-496"><a href="#cb11-496"></a><span class="cf">for</span> (k, v), ax1, ax <span class="kw">in</span> <span class="bu">zip</span>(port_corr.dists.items(), axi0, axi1):</span>
<span id="cb11-497"><a href="#cb11-497"></a>    <span class="cf">if</span> k <span class="op">==</span> <span class="st">'ccoc'</span>:</span>
<span id="cb11-498"><a href="#cb11-498"></a>        ax.plot([<span class="dv">0</span>,<span class="dv">1</span>], [<span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span> wacc)]<span class="op">*</span><span class="dv">2</span>)</span>
<span id="cb11-499"><a href="#cb11-499"></a>        ax.plot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="st">'r*'</span>)</span>
<span id="cb11-500"><a href="#cb11-500"></a>    <span class="cf">else</span>:</span>
<span id="cb11-501"><a href="#cb11-501"></a>        ax.plot(xs, v.g_prime(xs[::<span class="op">-</span><span class="dv">1</span>]))</span>
<span id="cb11-502"><a href="#cb11-502"></a>    ax.plot([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">1</span>,<span class="dv">1</span>], lw<span class="op">=</span><span class="fl">.5</span>, c<span class="op">=</span><span class="st">'k'</span>)</span>
<span id="cb11-503"><a href="#cb11-503"></a>    ax.<span class="bu">set</span>(ylim<span class="op">=</span>[<span class="op">-</span><span class="fl">0.05</span>, <span class="fl">2.5</span>], xlabel<span class="op">=</span><span class="st">'Percentile'</span>)</span>
<span id="cb11-504"><a href="#cb11-504"></a>    <span class="cf">if</span> ax <span class="kw">is</span> axs[<span class="dv">0</span>]:</span>
<span id="cb11-505"><a href="#cb11-505"></a>        ax.<span class="bu">set</span>(ylabel<span class="op">=</span><span class="st">'Weight adjustment'</span>)</span>
<span id="cb11-506"><a href="#cb11-506"></a></span>
<span id="cb11-507"><a href="#cb11-507"></a>    ax1.plot(xs, v.g(xs))</span>
<span id="cb11-508"><a href="#cb11-508"></a>    ax1.plot([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">0</span>, <span class="dv">1</span>], <span class="st">'k'</span>, lw<span class="op">=</span><span class="fl">.25</span>)</span>
<span id="cb11-509"><a href="#cb11-509"></a>    k <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">(</span><span class="sc">{</span>v<span class="sc">.</span>shape<span class="sc">:.3f}</span><span class="ss">)'</span></span>
<span id="cb11-510"><a href="#cb11-510"></a>    ax1.<span class="bu">set</span>(title<span class="op">=</span>k, ylim<span class="op">=</span>[<span class="op">-</span><span class="fl">0.025</span>, <span class="fl">1.025</span>])</span>
<span id="cb11-511"><a href="#cb11-511"></a>    <span class="cf">if</span> ax1 <span class="kw">is</span> axs[<span class="dv">0</span>][<span class="dv">0</span>]:</span>
<span id="cb11-512"><a href="#cb11-512"></a>        ax1.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Exceedance prob, s'</span>,</span>
<span id="cb11-513"><a href="#cb11-513"></a>                ylabel<span class="op">=</span><span class="st">'g(s)'</span>,</span>
<span id="cb11-514"><a href="#cb11-514"></a>                aspect<span class="op">=</span><span class="st">'equal'</span>)</span>
<span id="cb11-515"><a href="#cb11-515"></a><span class="in">```</span></span>
<span id="cb11-516"><a href="#cb11-516"></a></span>
<span id="cb11-517"><a href="#cb11-517"></a>@tbl-all-distortion-realistic-pricing compares the indicated pricing by unit and distortion. <span class="co">&lt;!--# In Table 9.17, recommend capitalizing "Total" in header row. --&gt;</span>It is computed using exactly the same method described for the simple discrete example. The calculations are easy enough that they can be performed in a spreadsheet, but that is not recommended unless you are very patient. @tbl-loss-ratios shows just the implied loss ratios. The total loss ratios are all the same because the distortions are all calibrated to the same overall total premium. Since WC has the heaviest tail, it gets the lowest target loss ratio under CCoC, which is the most tail-risk averse. In fact, CCoC is so tail-risk averse that GL (which offers some diversification because of the correlation structure) gets a target over 100%. This is typical CCoC behavior---cat is really expensive; everything else is cheaper. The reason is clear when you remember CCoC pricing is just a weighted average of the mean and the max. The other distortions are more reasonable. TVaR and dual are quite similar and focus more on volatility risk. Since all three lines are similarly volatile, it is no surprise their target loss ratios are also similar under this view.</span>
<span id="cb11-518"><a href="#cb11-518"></a></span>
<span id="cb11-519"><a href="#cb11-519"></a>This analysis---and indeed the whole monograph---has ignored several important elements: expenses, taxes, and the time value of money. Expenses are relatively easy to incorporate: acquisition expenses are typically amortized over the policy term, administration expenses span the policy term and claim payout period, and claim expenses can be bundled with losses. Taxes, however, are a Byzantine labyrinth requiring careful modeling at the level of legal entity and country. Their treatment is up to each insurer, and it's hard to offer even vague general guidance. Finally, time value of money brings real conceptual and computational difficulty (as opposed to the man-made complexity of taxes). It is the quantum gravity of insurance pricing. For some early thoughts, see the forthcoming monograph Pricing Multi-Period Insurance Risk by your intrepid second author. <span class="co">&lt;!--# Is there a prepublication link or something we can place here? Or even an entry in the references? --&gt;</span></span>
<span id="cb11-520"><a href="#cb11-520"></a></span>
<span id="cb11-523"><a href="#cb11-523"></a><span class="in">```{python}</span></span>
<span id="cb11-524"><a href="#cb11-524"></a><span class="co">#| echo: false</span></span>
<span id="cb11-525"><a href="#cb11-525"></a><span class="co">#| label: tbl-all-distortion-realistic-pricing</span></span>
<span id="cb11-526"><a href="#cb11-526"></a><span class="co">#| tbl-cap: Pricing by distortion.</span></span>
<span id="cb11-527"><a href="#cb11-527"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb11-528"><a href="#cb11-528"></a><span class="co">#| tbl-subcap: [CCoC, PH, Wang, Dual, TVaR]</span></span>
<span id="cb11-529"><a href="#cb11-529"></a></span>
<span id="cb11-530"><a href="#cb11-530"></a><span class="cf">for</span> k, g <span class="kw">in</span> port_corr.dists.items():</span>
<span id="cb11-531"><a href="#cb11-531"></a>    display(fGT(</span>
<span id="cb11-532"><a href="#cb11-532"></a>        port_corr.price(reg_p, g, allocation<span class="op">=</span><span class="st">'lifted'</span>).df[jam_order].T.droplevel(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb11-533"><a href="#cb11-533"></a>    ))</span>
<span id="cb11-534"><a href="#cb11-534"></a><span class="in">```</span></span>
<span id="cb11-535"><a href="#cb11-535"></a></span>
<span id="cb11-538"><a href="#cb11-538"></a><span class="in">```{python}</span></span>
<span id="cb11-539"><a href="#cb11-539"></a><span class="co">#| echo: false</span></span>
<span id="cb11-540"><a href="#cb11-540"></a><span class="co">#| label: tbl-loss-ratios</span></span>
<span id="cb11-541"><a href="#cb11-541"></a><span class="co">#| tbl-cap: "Implied loss ratio by unit by pricing by distortion (extract from previous tables)."</span></span>
<span id="cb11-542"><a href="#cb11-542"></a>ansd <span class="op">=</span> port_corr.analyze_distortions(p<span class="op">=</span>reg_p, efficient<span class="op">=</span><span class="va">True</span>, add_comps<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb11-543"><a href="#cb11-543"></a>bit <span class="op">=</span> ansd.comp_df.xs(<span class="st">'LR'</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb11-544"><a href="#cb11-544"></a>bit <span class="op">=</span> bit.iloc[[<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">3</span>]]</span>
<span id="cb11-545"><a href="#cb11-545"></a>fGT(bit, ratio_cols<span class="op">=</span>[<span class="st">'Auto'</span>, <span class="st">'GL'</span>, <span class="st">'WC'</span>, <span class="st">'total'</span>])</span>
<span id="cb11-546"><a href="#cb11-546"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>DRAFT - do not redistribute</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>